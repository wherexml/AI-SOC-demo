<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIå­¦ä¹ ä¸­å¿ƒ - XDRæ™ºèƒ½è¿è¥ç³»ç»Ÿ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e40af',
                        secondary: '#64748b',
                        accent: '#3b82f6',
                        success: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444',
                        ai: '#8b5cf6',
                        learning: '#06b6d4'
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'bounce-subtle': 'bounceSubtle 0.6s ease-in-out',
                        'glow': 'glow 2s ease-in-out infinite alternate'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes bounceSubtle {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes glow {
            from { box-shadow: 0 0 10px rgba(139, 92, 246, 0.3); }
            to { box-shadow: 0 0 20px rgba(139, 92, 246, 0.6); }
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .learning-badge {
            background: linear-gradient(135deg, #8b5cf6, #06b6d4);
        }
        .knowledge-item:hover .teach-ai-btn {
            opacity: 1;
        }
        .teach-ai-btn {
            opacity: 0;
            transition: opacity 0.2s ease;
        }
        .floating-toolbar {
            background: linear-gradient(135deg, #8b5cf6, #06b6d4);
            box-shadow: 0 4px 20px rgba(139, 92, 246, 0.3);
            animation: fadeInScale 0.2s ease-out;
            border: 2px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        @keyframes fadeInScale {
            from { 
                opacity: 0; 
                transform: scale(0.8) translateY(10px); 
            }
            to { 
                opacity: 1; 
                transform: scale(1) translateY(0); 
            }
        }
        .selectable-text {
            user-select: text;
            cursor: text;
        }
        .selectable-text::selection {
            background: rgba(139, 92, 246, 0.3);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- é¡µé¢æ ‡é¢˜åŒºåŸŸ -->
    <div class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 bg-gradient-to-r from-ai to-learning rounded-xl flex items-center justify-center">
                        <i class="fas fa-brain text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">AIå­¦ä¹ ä¸­å¿ƒ</h1>
                        <p class="text-sm text-gray-600">è®©AIå­¦ä¹ æ‚¨çš„ä¸šåŠ¡çŸ¥è¯†ï¼Œæä¾›ä¸ªæ€§åŒ–å®‰å…¨åˆ†æ</p>
                    </div>
                </div>
                <div class="flex items-center space-x-3">
                    <div class="text-sm text-gray-500">
                        <i class="fas fa-database mr-1"></i>
                        å·²å­¦ä¹ çŸ¥è¯†é¡¹: <span class="font-bold text-ai">156</span>
                    </div>
                    <div class="text-sm text-gray-500">
                        <i class="fas fa-lightbulb mr-1"></i>
                        ä»Šæ—¥æ–°å¢: <span class="font-bold text-learning">8</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="max-w-7xl mx-auto px-6 py-6">
        <!-- å¯¼èˆªæ ‡ç­¾é¡µ -->
        <div class="mb-6">
            <nav class="flex space-x-8">
                <button class="tab-btn active" data-tab="assets">
                    <i class="fas fa-server mr-2"></i>
                    èµ„äº§å­¦ä¹ ä¸­å¿ƒ
                </button>
                <button class="tab-btn" data-tab="judgment">
                    <i class="fas fa-gavel mr-2"></i>
                    ç ”åˆ¤çŸ¥è¯†åº“
                </button>
                <button class="tab-btn" data-tab="context">
                    <i class="fas fa-hand-pointer mr-2"></i>
                    åœ¨åœºå­¦ä¹ 
                </button>
                <button class="tab-btn" data-tab="analytics">
                    <i class="fas fa-chart-line mr-2"></i>
                    å­¦ä¹ ç»Ÿè®¡
                </button>
            </nav>
        </div>

        <!-- èµ„äº§å­¦ä¹ ä¸­å¿ƒ -->
        <div id="assets-tab" class="tab-content">
            <div class="space-y-6">
                <!-- èµ„äº§çŸ¥è¯†åˆ—è¡¨ -->
                <div>
                    <div class="bg-white rounded-lg shadow-sm border card-hover">
                        <div class="p-6 border-b border-gray-200">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-semibold text-gray-900">
                                    <i class="fas fa-list-ul text-ai mr-2"></i>
                                    èµ„äº§çŸ¥è¯†åˆ—è¡¨
                                </h3>
                                <button onclick="addAssetKnowledge()" class="bg-ai text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors">
                                    <i class="fas fa-plus mr-2"></i>
                                    æ–°å¢èµ„äº§çŸ¥è¯†
                                </button>
                            </div>
                            <div class="mt-4 flex space-x-4">
                                <input type="text" id="asset-search" placeholder="æœç´¢IPã€æ ‡ç­¾æˆ–ä¸šåŠ¡å½’å±..." 
                                       oninput="searchAssetKnowledge()"
                                       class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai focus:border-transparent">
                                <select id="asset-filter" onchange="filterAssetKnowledge()" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                                    <option value="">å…¨éƒ¨ç±»å‹</option>
                                    <option value="æœåŠ¡å™¨">æœåŠ¡å™¨</option>
                                    <option value="ç½‘ç»œè®¾å¤‡">ç½‘ç»œè®¾å¤‡</option>
                                    <option value="å®‰å…¨è®¾å¤‡">å®‰å…¨è®¾å¤‡</option>
                                    <option value="ä¸šåŠ¡ç³»ç»Ÿ">ä¸šåŠ¡ç³»ç»Ÿ</option>
                                </select>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">å®ä½“</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">èµ„äº§æ ‡ç­¾</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ä¸šåŠ¡å½’å±</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">å­¦ä¹ æ¥æº</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="asset-knowledge-list">
                                    <!-- åŠ¨æ€ç”Ÿæˆçš„èµ„äº§çŸ¥è¯†æ¡ç›® -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- AIæ™ºèƒ½å»ºè®® -->
                <div>
                    <div class="bg-white rounded-lg shadow-sm border card-hover">
                        <div class="p-6 border-b border-gray-200">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-900">
                                        <i class="fas fa-robot text-ai mr-2"></i>
                                        AIæ™ºèƒ½å»ºè®®
                                    </h3>
                                    <p class="text-sm text-gray-600 mt-1">åŸºäºæµé‡åˆ†æå’Œè¡Œä¸ºæ¨¡å¼çš„æ™ºèƒ½å‘ç°</p>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-ai rounded-full animate-pulse"></div>
                                    <span class="text-xs text-ai font-medium">å®æ—¶åˆ†æä¸­</span>
                                </div>
                            </div>
                        </div>
                        <div class="p-6" id="ai-suggestions">
                            <!-- AIå»ºè®®å†…å®¹ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç ”åˆ¤çŸ¥è¯†åº“ -->
        <div id="judgment-tab" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <!-- AIæ¨¡å¼è¯†åˆ«åº“ -->
                <div class="bg-white rounded-lg shadow-sm border card-hover">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">
                                    <i class="fas fa-brain text-ai mr-2"></i>
                                    AIæ¨¡å¼è¯†åˆ«åº“
                                </h3>
                                <p class="text-sm text-gray-600 mt-1">AIè‡ªåŠ¨å­¦ä¹ çš„è¡Œä¸ºæ¨¡å¼å’Œè‰¯æ€§ç‰¹å¾</p>
                            </div>
                            <button onclick="addTrustedFeature()" class="bg-ai text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors">
                                <i class="fas fa-robot mr-2"></i>
                                æ•™AIå­¦ä¹ 
                            </button>
                        </div>
                        <!-- AIå­¦ä¹ ç»Ÿè®¡æ¡ -->
                        <div class="mt-4 grid grid-cols-3 gap-4">
                            <div class="text-center">
                                <div class="text-2xl font-bold text-ai">87%</div>
                                <div class="text-xs text-gray-500">å­¦ä¹ å‡†ç¡®ç‡</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-success">156</div>
                                <div class="text-xs text-gray-500">å·²è¯†åˆ«æ¨¡å¼</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-warning">23</div>
                                <div class="text-xs text-gray-500">å¾…ç¡®è®¤æ¨¡å¼</div>
                            </div>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="space-y-4" id="trusted-features-list">
                            <!-- AIæ¨¡å¼è¯†åˆ«åˆ—è¡¨ -->
                        </div>
                    </div>
                </div>

                <!-- AIæ™ºèƒ½è§„åˆ™å¼•æ“ -->
                <div class="bg-white rounded-lg shadow-sm border card-hover">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">
                                    <i class="fas fa-atom text-ai mr-2"></i>
                                    AIæ™ºèƒ½è§„åˆ™å¼•æ“
                                </h3>
                                <p class="text-sm text-gray-600 mt-1">åŸºäºæœºå™¨å­¦ä¹ çš„è‡ªé€‚åº”å¨èƒæ£€æµ‹è§„åˆ™</p>
                            </div>
                            <button onclick="addCustomRule()" class="bg-gradient-to-r from-purple-500 to-blue-500 text-white px-4 py-2 rounded-lg hover:from-purple-600 hover:to-blue-600 transition-all">
                                <i class="fas fa-magic mr-2"></i>
                                AIç”Ÿæˆè§„åˆ™
                            </button>
                        </div>
                        <!-- è§„åˆ™å­¦ä¹ çŠ¶æ€ -->
                        <div class="mt-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg p-3">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <div class="text-sm">
                                        <span class="text-gray-600">æ´»è·ƒè§„åˆ™:</span>
                                        <span class="font-bold text-ai">12æ¡</span>
                                    </div>
                                    <div class="text-sm">
                                        <span class="text-gray-600">AIä¼˜åŒ–:</span>
                                        <span class="font-bold text-success">+18%</span>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                                    <span class="text-xs text-green-600">å®æ—¶å­¦ä¹ ä¸­</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="space-y-4" id="custom-rules-list">
                            <!-- AIæ™ºèƒ½è§„åˆ™åˆ—è¡¨ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- åœ¨åœºå­¦ä¹  -->
        <div id="context-tab" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- å­¦ä¹ æ¼”ç¤ºåŒºåŸŸ -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-lg shadow-sm border card-hover">
                        <div class="p-6 border-b border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-900">
                                <i class="fas fa-mouse-pointer text-learning mr-2"></i>
                                åœ¨åœºå­¦ä¹ æ¼”ç¤º
                            </h3>
                            <p class="text-sm text-gray-600 mt-1">åœ¨åˆ†æç•Œé¢ç›´æ¥åˆ’é€‰æ–‡æœ¬æˆ–ç‚¹å‡»IPåœ°å€ï¼Œå³å¯æ•™AIå­¦ä¹ </p>
                        </div>
                        <div class="p-6">
                            <!-- æ¨¡æ‹Ÿå‘Šè­¦è¯¦æƒ… -->
                            <div class="bg-gray-50 rounded-lg p-4 mb-4">
                                <h4 class="font-medium text-gray-800 mb-3">æ¨¡æ‹Ÿå‘Šè­¦è¯¦æƒ…ï¼š</h4>
                                <div class="space-y-3">
                                    <div class="flex items-center space-x-4">
                                        <span class="text-sm text-gray-600">æ”»å‡»æºIP:</span>
                                        <span class="knowledge-item font-mono text-blue-600 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded relative group">
                                            192.168.10.50
                                            <button onclick="teachAI('ip', '192.168.10.50')" class="teach-ai-btn absolute -top-2 -right-2 w-6 h-6 bg-ai text-white rounded-full text-xs hover:bg-purple-700">
                                                ğŸ§ 
                                            </button>
                                        </span>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <span class="text-sm text-gray-600">ç›®æ ‡IP:</span>
                                        <span class="knowledge-item font-mono text-blue-600 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded relative group">
                                            10.10.10.10
                                            <button onclick="teachAI('ip', '10.10.10.10')" class="teach-ai-btn absolute -top-2 -right-2 w-6 h-6 bg-ai text-white rounded-full text-xs hover:bg-purple-700">
                                                ğŸ§ 
                                            </button>
                                        </span>
                                    </div>
                                    <div>
                                        <span class="text-sm text-gray-600 block mb-2">HTTPè¯·æ±‚è¯¦æƒ…:</span>
                                        <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-4 font-mono text-sm selectable-text hover:border-ai hover:bg-blue-50 transition-colors cursor-text" id="demo-payload">
                                            <div class="text-xs text-gray-500 mb-2">
                                                <i class="fas fa-mouse-pointer mr-1"></i>
                                                è¯•è¯•åˆ’é€‰ä¸‹é¢çš„æ–‡æœ¬ï¼Œç‰¹åˆ«æ˜¯é«˜äº®çš„éƒ¨åˆ†
                                            </div>
GET /admin/login HTTP/1.1
Host: 10.10.10.10
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 <span class="bg-yellow-200 px-1 rounded border border-yellow-400 font-semibold cursor-pointer hover:bg-yellow-300 transition-colors">HealthChecker/1.0</span>
Accept: text/html,application/xhtml+xml
Connection: keep-alive
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- å­¦ä¹ æŒ‡å¯¼ -->
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <h5 class="font-medium text-blue-800 mb-3">
                                    <i class="fas fa-lightbulb mr-2"></i>
                                    å­¦ä¹ æ“ä½œæŒ‡å—
                                </h5>
                                <div class="space-y-3">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold">1</div>
                                        <div class="text-sm text-blue-700">
                                            <strong>æ ‡è®°èµ„äº§å±æ€§ï¼š</strong> ç‚¹å‡»IPåœ°å€æ—çš„ ğŸ§  å›¾æ ‡ï¼Œå¯æ ‡è®°èµ„äº§å±æ€§
                                        </div>
                                    </div>
                                    <div class="flex items-start space-x-3">
                                        <div class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold">2</div>
                                        <div class="text-sm text-blue-700">
                                            <strong>åˆ’é€‰æ–‡æœ¬å­¦ä¹ ï¼š</strong> ç”¨é¼ æ ‡åˆ’é€‰HTTPè¯·æ±‚ä¸­çš„ <span class="bg-yellow-200 px-1 rounded font-mono">"HealthChecker/1.0"</span> æ–‡æœ¬ï¼Œä¼šå¼¹å‡ºæµ®åŠ¨å·¥å…·æ¡
                                        </div>
                                    </div>
                                    <div class="flex items-start space-x-3">
                                        <div class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold">3</div>
                                        <div class="text-sm text-blue-700">
                                            <strong>ç¡®è®¤å­¦ä¹ ï¼š</strong> ç‚¹å‡»æµ®åŠ¨å·¥å…·æ¡ä¸­çš„"æ ‡è®°ä¸ºè‰¯æ€§"æŒ‰é’®ï¼ŒAIä¼šè®°ä½è¿™ä¸ªç‰¹å¾
                                        </div>
                                    </div>
                                    <div class="bg-white rounded p-2 mt-2">
                                        <div class="text-xs text-blue-600">
                                            <i class="fas fa-info-circle mr-1"></i>
                                            <strong>æç¤ºï¼š</strong> æ‰€æœ‰å­¦ä¹ çš„çŸ¥è¯†éƒ½ä¼šç«‹å³ç”Ÿæ•ˆï¼Œæå‡AIåˆ†æå‡†ç¡®æ€§
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å­¦ä¹ è®°å½• -->
                <div>
                    <div class="bg-white rounded-lg shadow-sm border card-hover">
                        <div class="p-6 border-b border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-900">
                                <i class="fas fa-history text-gray-600 mr-2"></i>
                                æœ€è¿‘å­¦ä¹ è®°å½•
                            </h3>
                        </div>
                        <div class="p-6">
                            <div class="space-y-4" id="recent-learning-list">
                                <!-- å­¦ä¹ è®°å½•åˆ—è¡¨ -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å­¦ä¹ ç»Ÿè®¡ -->
        <div id="analytics-tab" class="tab-content hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                <!-- ç»Ÿè®¡å¡ç‰‡ -->
                <div class="bg-white rounded-lg shadow-sm border card-hover p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-ai/10 rounded-lg flex items-center justify-center">
                            <i class="fas fa-database text-ai text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <h4 class="text-2xl font-bold text-gray-900">156</h4>
                            <p class="text-sm text-gray-600">æ€»çŸ¥è¯†é¡¹</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-sm border card-hover p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-learning/10 rounded-lg flex items-center justify-center">
                            <i class="fas fa-server text-learning text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <h4 class="text-2xl font-bold text-gray-900">89</h4>
                            <p class="text-sm text-gray-600">èµ„äº§çŸ¥è¯†</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-sm border card-hover p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-success/10 rounded-lg flex items-center justify-center">
                            <i class="fas fa-check-shield text-success text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <h4 class="text-2xl font-bold text-gray-900">67</h4>
                            <p class="text-sm text-gray-600">å¯ä¿¡ç‰¹å¾</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-sm border card-hover p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-gradient-to-r from-red-100 to-green-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-sync-alt text-green-600 text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <h4 class="text-2xl font-bold text-green-600">23æ¬¡</h4>
                            <p class="text-sm text-gray-600">AIçº æ­£è¯¯åˆ¤</p>
                            <p class="text-xs text-green-500 mt-1">å‡†ç¡®ç‡æå‡+15%</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AIä¼˜åŒ–æˆæœå±•ç¤º -->
            <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg shadow-sm border border-blue-200 p-6 mb-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-brain text-white text-lg"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">AIä¼˜åŒ–æˆæœ</h3>
                            <p class="text-sm text-gray-600">æœ€æ–°çš„AIå­¦ä¹ å’Œä¼˜åŒ–è¡¨ç°</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                        <span class="text-xs text-green-600 font-medium">å®æ—¶ä¼˜åŒ–ä¸­</span>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white rounded-lg p-4 border border-blue-100">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-red-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-exclamation-triangle text-red-500 text-sm"></i>
                            </div>
                            <div>
                                <div class="text-sm font-medium text-gray-800">çº æ­£äººå·¥è¯¯åˆ¤</div>
                                <div class="text-xs text-gray-500">æœ€è¿‘7å¤©</div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="text-2xl font-bold text-red-500">8æ¬¡</div>
                            <div class="text-xs text-gray-600">åŒ…å«æœå°‘çš„3æ¬¡è¯¯åˆ¤</div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border border-green-100">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-check-circle text-green-500 text-sm"></i>
                            </div>
                            <div>
                                <div class="text-sm font-medium text-gray-800">å‡†ç¡®ç‡æå‡</div>
                                <div class="text-xs text-gray-500">å¯¹æ¯”ä¸Šå‘¨</div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="text-2xl font-bold text-green-500">+15%</div>
                            <div class="text-xs text-gray-600">ä»87%æå‡è‡³92%</div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border border-purple-100">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-lightbulb text-purple-500 text-sm"></i>
                            </div>
                            <div>
                                <div class="text-sm font-medium text-gray-800">æ™ºèƒ½å»ºè®®</div>
                                <div class="text-xs text-gray-500">å·²è¢«é‡‡çº³</div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="text-2xl font-bold text-purple-500">16æ¡</div>
                            <div class="text-xs text-gray-600">é‡‡çº³ç‡89%</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å­¦ä¹ è¶‹åŠ¿å›¾ -->
            <div class="bg-white rounded-lg shadow-sm border card-hover">
                <div class="p-6 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900">
                        <i class="fas fa-chart-area text-ai mr-2"></i>
                        å­¦ä¹ è¶‹åŠ¿åˆ†æ
                    </h3>
                </div>
                <div class="p-6">
                    <div class="h-64 flex items-center justify-center border-2 border-dashed border-gray-300 rounded-lg">
                        <div class="text-center">
                            <i class="fas fa-chart-line text-gray-400 text-4xl mb-4"></i>
                            <p class="text-gray-500">å­¦ä¹ è¶‹åŠ¿å›¾è¡¨åŒºåŸŸ</p>
                            <p class="text-sm text-gray-400">å¯é›†æˆChart.jsç­‰å›¾è¡¨åº“æ˜¾ç¤ºæ•°æ®</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- æµ®åŠ¨å·¥å…·æ¡ï¼ˆç”¨äºæ–‡æœ¬é€‰æ‹©åæ˜¾ç¤ºï¼‰ -->
    <div id="floating-toolbar" class="fixed hidden floating-toolbar text-white px-4 py-2 rounded-lg" style="z-index: 9999;">
        <div class="flex items-center space-x-2">
            <div class="text-xs opacity-75 mr-2">é€‰ä¸­: "<span id="selected-text-preview"></span>"</div>
            <button class="hover:bg-white/20 px-3 py-1 rounded text-sm font-medium transition-colors" onclick="markAsGood()">
                <i class="fas fa-check mr-1"></i>æ ‡è®°ä¸ºè‰¯æ€§
            </button>
            <button class="hover:bg-white/20 px-3 py-1 rounded text-sm font-medium transition-colors" onclick="markAsThreat()">
                <i class="fas fa-exclamation-triangle mr-1"></i>å®šä¹‰ä¸ºå¨èƒ
            </button>
            <button class="hover:bg-white/20 px-3 py-1 rounded text-sm font-medium transition-colors" onclick="globalSearch()">
                <i class="fas fa-search mr-1"></i>å…¨å±€æœç´¢
            </button>
        </div>
    </div>

    <!-- å­¦ä¹ å¼¹çª—æ¨¡æ€æ¡† -->
    <div id="learning-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                    <h3 class="text-lg font-semibold text-gray-900">
                        <i class="fas fa-brain text-ai mr-2"></i>
                        æ•™AIå­¦ä¹ 
                    </h3>
                    <button class="text-gray-400 hover:text-gray-600" onclick="closeLearningModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="p-6" id="learning-modal-content">
                <!-- åŠ¨æ€å†…å®¹ -->
            </div>
        </div>
    </div>

    <script>
        // æ ‡ç­¾é¡µåˆ‡æ¢åŠŸèƒ½
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabId = this.dataset.tab;
                
                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // æ˜¾ç¤ºå¯¹åº”å†…å®¹
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.add('hidden');
                });
                document.getElementById(tabId + '-tab').classList.remove('hidden');
            });
        });

        // åˆå§‹åŒ–æ•°æ®
        document.addEventListener('DOMContentLoaded', function() {
            initializeAssetKnowledge();
            initializeTrustedFeatures();
            initializeAISuggestions();
            initializeRecentLearning();
            initializeCustomRules();
            setupTextSelection();
        });

        // èµ„äº§çŸ¥è¯†æ•°æ®å­˜å‚¨
        let assetKnowledgeData = [
            {
                id: 1,
                entity: '192.168.50.98',
                tags: ['æ¼æ‰«æœåŠ¡å™¨', 'å®‰å…¨è®¾å¤‡'],
                business: 'å®‰å…¨è¿ç»´éƒ¨',
                source: 'AIæ™ºèƒ½è¯†åˆ«',
                time: '2025-06-29 11:30'
            },
            {
                id: 2,
                entity: '10.20.100.5',
                tags: ['ä»£ç†æœåŠ¡å™¨', 'ç½‘ç»œè®¾å¤‡'],
                business: 'ç½‘ç»œè¿ç»´éƒ¨',
                source: 'AIæ™ºèƒ½è¯†åˆ«',
                time: '2025-06-29 11:25'
            },
            {
                id: 3,
                entity: '172.16.88.12',
                tags: ['ä»£ç†æœåŠ¡å™¨', 'è´Ÿè½½å‡è¡¡'],
                business: 'åº”ç”¨è¿ç»´éƒ¨',
                source: 'AIæ™ºèƒ½è¯†åˆ«',
                time: '2025-06-29 11:20'
            },
            {
                id: 4,
                entity: '192.168.1.100',
                tags: ['WebæœåŠ¡å™¨', 'ç”Ÿäº§ç¯å¢ƒ'],
                business: 'ç”µå•†å¹³å°',
                source: 'ç”±å¼ å·¥æ‰‹åŠ¨æ·»åŠ ',
                time: '2025-06-29 14:30'
            },
            {
                id: 5,
                entity: '10.10.10.10', 
                tags: ['è‡ªåŠ¨åŒ–è¿ç»´å¹³å°'],
                business: 'è¿ç»´éƒ¨',
                source: 'ä»äº‹ä»¶INC-123å­¦ä¹ ',
                time: '2025-06-29 16:45'
            },
            {
                id: 6,
                entity: '172.16.0.50',
                tags: ['æ•°æ®åº“æœåŠ¡å™¨', 'æ ¸å¿ƒç³»ç»Ÿ'],
                business: 'ç ”å‘éƒ¨-æ ¸å¿ƒäº¤æ˜“ç»„',
                source: 'ç”±æç»ç†æ‰‹åŠ¨æ·»åŠ ',
                time: '2025-06-28 09:20'
            }
        ];

        // åˆå§‹åŒ–èµ„äº§çŸ¥è¯†åˆ—è¡¨
        function initializeAssetKnowledge() {
            renderAssetKnowledgeList();
        }

        // æ¸²æŸ“èµ„äº§çŸ¥è¯†åˆ—è¡¨
        function renderAssetKnowledgeList(filteredData = null) {
            const data = filteredData || assetKnowledgeData;
            const tbody = document.getElementById('asset-knowledge-list');
            
            tbody.innerHTML = data.map(item => `
                <tr class="hover:bg-gray-50" data-id="${item.id}">
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="font-mono text-sm text-blue-600">${item.entity}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex flex-wrap gap-1">
                            ${item.tags.map(tag => `<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-ai/10 text-ai">${tag}</span>`).join('')}
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.business}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${item.source}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="editAssetKnowledge(${item.id})" class="text-ai hover:text-purple-700 mr-3">ç¼–è¾‘</button>
                        <button onclick="deleteAssetKnowledge(${item.id})" class="text-red-600 hover:text-red-800">åˆ é™¤</button>
                    </td>
                </tr>
            `).join('');
        }

        // æ·»åŠ èµ„äº§çŸ¥è¯†
        function addAssetKnowledge() {
            showAssetKnowledgeModal();
        }

        // ç¼–è¾‘èµ„äº§çŸ¥è¯†
        function editAssetKnowledge(id) {
            const asset = assetKnowledgeData.find(item => item.id === id);
            if (asset) {
                showAssetKnowledgeModal(asset);
            }
        }

        // åˆ é™¤èµ„äº§çŸ¥è¯†
        function deleteAssetKnowledge(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡èµ„äº§çŸ¥è¯†å—ï¼Ÿ')) {
                assetKnowledgeData = assetKnowledgeData.filter(item => item.id !== id);
                renderAssetKnowledgeList();
                showNotification('èµ„äº§çŸ¥è¯†å·²åˆ é™¤', 'success');
                updateStatistics();
            }
        }

        // æ˜¾ç¤ºèµ„äº§çŸ¥è¯†ç¼–è¾‘æ¨¡æ€æ¡†
        function showAssetKnowledgeModal(asset = null) {
            const modal = document.getElementById('learning-modal');
            const content = document.getElementById('learning-modal-content');
            
            const isEdit = asset !== null;
            content.innerHTML = `
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">èµ„äº§å®ä½“</label>
                        <input type="text" id="asset-entity" value="${asset ? asset.entity : ''}" 
                               placeholder="192.168.1.100 æˆ– server-name" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">èµ„äº§æ ‡ç­¾</label>
                        <input type="text" id="asset-tags" value="${asset ? asset.tags.join(', ') : ''}" 
                               placeholder="WebæœåŠ¡å™¨, ç”Ÿäº§ç¯å¢ƒ" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                        <p class="text-xs text-gray-500 mt-1">å¤šä¸ªæ ‡ç­¾ç”¨é€—å·åˆ†éš”</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ä¸šåŠ¡å½’å±</label>
                        <input type="text" id="asset-business" value="${asset ? asset.business : ''}" 
                               placeholder="ç”µå•†å¹³å°" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                    </div>
                    <div class="flex space-x-3">
                        <button onclick="saveAssetKnowledge(${asset ? asset.id : 'null'})" 
                                class="flex-1 bg-ai text-white py-2 rounded-lg hover:bg-purple-700">
                            ${isEdit ? 'ä¿å­˜ä¿®æ”¹' : 'æ·»åŠ èµ„äº§çŸ¥è¯†'}
                        </button>
                        <button onclick="closeLearningModal()" 
                                class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                            å–æ¶ˆ
                        </button>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // ä¿å­˜èµ„äº§çŸ¥è¯†
        function saveAssetKnowledge(id) {
            const entity = document.getElementById('asset-entity').value.trim();
            const tags = document.getElementById('asset-tags').value.split(',').map(tag => tag.trim()).filter(tag => tag);
            const business = document.getElementById('asset-business').value.trim();
            
            if (!entity) {
                showNotification('è¯·å¡«å†™èµ„äº§å®ä½“', 'error');
                return;
            }
            
            const assetData = {
                entity,
                tags,
                business,
                source: id ? 'ç”¨æˆ·ä¿®æ”¹' : 'ç”¨æˆ·æ‰‹åŠ¨æ·»åŠ ',
                time: new Date().toLocaleString('zh-CN')
            };
            
            if (id) {
                // ç¼–è¾‘ç°æœ‰èµ„äº§
                const index = assetKnowledgeData.findIndex(item => item.id === id);
                if (index !== -1) {
                    assetKnowledgeData[index] = { ...assetKnowledgeData[index], ...assetData };
                }
                showNotification('èµ„äº§çŸ¥è¯†å·²æ›´æ–°', 'success');
            } else {
                // æ·»åŠ æ–°èµ„äº§
                const newAsset = {
                    id: Date.now(),
                    ...assetData
                };
                assetKnowledgeData.push(newAsset);
                showNotification('èµ„äº§çŸ¥è¯†å·²æ·»åŠ ', 'success');
            }
            
            renderAssetKnowledgeList();
            closeLearningModal();
            updateStatistics();
        }

        // æœç´¢èµ„äº§çŸ¥è¯†
        function searchAssetKnowledge() {
            const searchTerm = document.getElementById('asset-search').value.toLowerCase();
            const filterType = document.getElementById('asset-filter').value;
            
            let filteredData = assetKnowledgeData;
            
            // æŒ‰æœç´¢è¯ç­›é€‰
            if (searchTerm) {
                filteredData = filteredData.filter(item => 
                    item.entity.toLowerCase().includes(searchTerm) ||
                    item.tags.some(tag => tag.toLowerCase().includes(searchTerm)) ||
                    item.business.toLowerCase().includes(searchTerm)
                );
            }
            
            // æŒ‰ç±»å‹ç­›é€‰
            if (filterType) {
                filteredData = filteredData.filter(item => 
                    item.tags.some(tag => tag.includes(filterType))
                );
            }
            
            renderAssetKnowledgeList(filteredData);
        }

        // ç­›é€‰èµ„äº§çŸ¥è¯†
        function filterAssetKnowledge() {
            searchAssetKnowledge(); // å¤ç”¨æœç´¢é€»è¾‘
        }



        // AIæ¨¡å¼è¯†åˆ«æ•°æ®å­˜å‚¨
        let trustedFeatures = [
            {
                id: 1,
                type: 'AIçº é”™ä¼˜åŒ–',
                content: 'çº æ­£æœå°‘å¯¹"192.168.50.98"çš„è¯¯åˆ¤',
                confidence: '98%',
                source: 'AIæ™ºèƒ½çº é”™',
                learningMethod: 'è¡Œä¸ºæ¨¡å¼å¯¹æ¯”',
                marker: 'AIçº æ­£ + ç³»ç»Ÿè‡ªåŠ¨éªŒè¯',
                time: '2025-06-29 19:15',
                relatedEvents: 23,
                effectiveness: '+35%',
                correctionType: 'æ¼æ‰«æœåŠ¡å™¨è¯†åˆ«'
            },
            {
                id: 2,
                type: 'AIçº é”™ä¼˜åŒ–',
                content: 'çº æ­£æœå°‘å¯¹"Python-requests"çš„å¨èƒåˆ¤æ–­',
                confidence: '94%',
                source: 'AIæ™ºèƒ½çº é”™',
                learningMethod: 'ä¸Šä¸‹æ–‡è¯­ä¹‰åˆ†æ',
                marker: 'AIçº æ­£ + ä¸“å®¶ç¡®è®¤',
                time: '2025-06-29 17:45',
                relatedEvents: 67,
                effectiveness: '+28%',
                correctionType: 'è‰¯æ€§å·¥å…·è¯†åˆ«'
            },
            {
                id: 3,
                type: 'GPTç ”åˆ¤ä¼˜åŒ–',
                content: 'SQLæ³¨å…¥ä¸Šä¸‹æ–‡è¯­ä¹‰åˆ†æ',
                confidence: '96%',
                source: 'GPTæ¨¡å‹è°ƒä¼˜',
                learningMethod: 'æ·±åº¦è¯­ä¹‰ç†è§£',
                marker: 'AIè‡ªä¸»å­¦ä¹  + å®‰å…¨ä¸“å®¶éªŒè¯',
                time: '2025-06-29 18:22',
                relatedEvents: 127,
                effectiveness: '+42%'
            },
            {
                id: 4,
                type: 'è‰¯æ€§æ¨¡å¼',
                content: 'HealthChecker/1.0',
                confidence: '92%',
                source: 'AIè‡ªåŠ¨è¯†åˆ«',
                learningMethod: 'è¡Œä¸ºåˆ†æ',
                marker: 'AI + æç»ç†ç¡®è®¤',
                time: '2025-06-29 16:45',
                relatedEvents: 45,
                effectiveness: '+23%'
            },
            {
                id: 5,
                type: 'è¿ç»´æ¨¡å¼',
                content: 'SELECT * FROM monitor_logs',
                confidence: '87%',
                source: 'AIå…³è”å­¦ä¹ ',
                learningMethod: 'ä¸Šä¸‹æ–‡åˆ†æ',
                marker: 'AI + å¼ å·¥ç¡®è®¤',
                time: '2025-06-29 10:30',
                relatedEvents: 12,
                effectiveness: '+18%'
            },
            {
                id: 6,
                type: 'å†…éƒ¨åŸŸå',
                content: 'internal-api.company.com',
                confidence: '95%',
                source: 'AIè‡ªåŠ¨å‘ç°',
                learningMethod: 'æµé‡æ¨¡å¼',
                marker: 'AI + ç‹å·¥ç¡®è®¤',
                time: '2025-06-28 15:20',
                relatedEvents: 78,
                effectiveness: '+31%'
            }
        ];

        // æ·»åŠ å¯ä¿¡ç‰¹å¾
        function addTrustedFeature() {
            showTrustedFeatureModal();
        }

        // æ˜¾ç¤ºå¯ä¿¡ç‰¹å¾æ¨¡æ€æ¡†
        function showTrustedFeatureModal(feature = null) {
            const modal = document.getElementById('learning-modal');
            const content = document.getElementById('learning-modal-content');
            
            const isEdit = feature !== null;
            content.innerHTML = `
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">AIå­¦ä¹ ç±»å‹</label>
                        <select id="feature-type" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                            <option value="è‰¯æ€§æ¨¡å¼" ${feature && feature.type === 'è‰¯æ€§æ¨¡å¼' ? 'selected' : ''}>è‰¯æ€§æ¨¡å¼è¯†åˆ«</option>
                            <option value="è¿ç»´æ¨¡å¼" ${feature && feature.type === 'è¿ç»´æ¨¡å¼' ? 'selected' : ''}>è¿ç»´è¡Œä¸ºæ¨¡å¼</option>
                            <option value="å†…éƒ¨åŸŸå" ${feature && feature.type === 'å†…éƒ¨åŸŸå' ? 'selected' : ''}>å†…éƒ¨åŸŸåæ¨¡å¼</option>
                            <option value="GPTç ”åˆ¤ä¼˜åŒ–" ${feature && feature.type === 'GPTç ”åˆ¤ä¼˜åŒ–' ? 'selected' : ''}>GPTç ”åˆ¤ä¼˜åŒ–</option>
                            <option value="ä¸šåŠ¡ç‰¹å¾" ${feature && feature.type === 'ä¸šåŠ¡ç‰¹å¾' ? 'selected' : ''}>ä¸šåŠ¡ç‰¹å¾æ¨¡å¼</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">æ¨¡å¼ç‰¹å¾</label>
                        <input type="text" id="feature-content" value="${feature ? feature.content : ''}" 
                               placeholder="HealthChecker/1.0 æˆ– SQLæ³¨å…¥ä¸Šä¸‹æ–‡è¯­ä¹‰åˆ†æ" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">å­¦ä¹ æ¥æº</label>
                        <select id="feature-scope" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                            <option value="AIè‡ªåŠ¨è¯†åˆ«" ${feature && feature.source === 'AIè‡ªåŠ¨è¯†åˆ«' ? 'selected' : ''}>AIè‡ªåŠ¨è¯†åˆ«</option>
                            <option value="AIå…³è”å­¦ä¹ " ${feature && feature.source === 'AIå…³è”å­¦ä¹ ' ? 'selected' : ''}>AIå…³è”å­¦ä¹ </option>
                            <option value="GPTæ¨¡å‹è°ƒä¼˜" ${feature && feature.source === 'GPTæ¨¡å‹è°ƒä¼˜' ? 'selected' : ''}>GPTæ¨¡å‹è°ƒä¼˜</option>
                            <option value="AIè‡ªåŠ¨å‘ç°" ${feature && feature.source === 'AIè‡ªåŠ¨å‘ç°' ? 'selected' : ''}>AIè‡ªåŠ¨å‘ç°</option>
                        </select>
                    </div>
                    <div class="flex space-x-3">
                        <button onclick="saveTrustedFeature(${feature ? feature.id : 'null'})" 
                                class="flex-1 bg-ai text-white py-2 rounded-lg hover:bg-purple-700">
                            ${isEdit ? 'ä¿å­˜ä¿®æ”¹' : 'æ·»åŠ AIå­¦ä¹ æ¨¡å¼'}
                        </button>
                        <button onclick="closeLearningModal()" 
                                class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                            å–æ¶ˆ
                        </button>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // ä¿å­˜AIå­¦ä¹ æ¨¡å¼
        function saveTrustedFeature(id) {
            const type = document.getElementById('feature-type').value;
            const content = document.getElementById('feature-content').value.trim();
            const source = document.getElementById('feature-scope').value;
            
            if (!content) {
                showNotification('è¯·å¡«å†™æ¨¡å¼ç‰¹å¾', 'error');
                return;
            }
            
            const featureData = {
                type,
                content,
                source,
                confidence: '95%',
                learningMethod: type === 'GPTç ”åˆ¤ä¼˜åŒ–' ? 'æ·±åº¦è¯­ä¹‰ç†è§£' : 'è¡Œä¸ºåˆ†æ',
                marker: 'AI + å½“å‰ç”¨æˆ·ç¡®è®¤',
                time: new Date().toLocaleString('zh-CN'),
                relatedEvents: Math.floor(Math.random() * 100) + 10,
                effectiveness: '+' + (Math.floor(Math.random() * 30) + 15) + '%'
            };
            
            if (id) {
                // ç¼–è¾‘ç°æœ‰æ¨¡å¼
                const index = trustedFeatures.findIndex(item => item.id === id);
                if (index !== -1) {
                    trustedFeatures[index] = { ...trustedFeatures[index], ...featureData };
                }
                showNotification('AIå­¦ä¹ æ¨¡å¼å·²æ›´æ–°', 'success');
            } else {
                // æ·»åŠ æ–°æ¨¡å¼
                const newFeature = {
                    id: Date.now(),
                    ...featureData
                };
                trustedFeatures.push(newFeature);
                showNotification('AIå­¦ä¹ æ¨¡å¼å·²æ·»åŠ ', 'success');
            }
            
            initializeTrustedFeatures();
            closeLearningModal();
            updateStatistics();
        }

        // åˆ é™¤AIå­¦ä¹ æ¨¡å¼
        function deleteTrustedFeature(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªAIå­¦ä¹ æ¨¡å¼å—ï¼Ÿ')) {
                trustedFeatures = trustedFeatures.filter(item => item.id !== id);
                initializeTrustedFeatures();
                showNotification('AIå­¦ä¹ æ¨¡å¼å·²åˆ é™¤', 'success');
                updateStatistics();
            }
        }

        // åˆå§‹åŒ–AIæ¨¡å¼è¯†åˆ«åº“
        function initializeTrustedFeatures() {
            const container = document.getElementById('trusted-features-list');
            container.innerHTML = trustedFeatures.map(feature => {
                const isCorrection = feature.type === 'AIçº é”™ä¼˜åŒ–';
                const bgClass = isCorrection ? 'bg-gradient-to-r from-orange-50 to-red-50 border-orange-200' : 'bg-gradient-to-r from-white to-purple-50 border-gray-200';
                const iconClass = isCorrection ? 'fa-sync-alt' : 'fa-brain';
                const iconColor = isCorrection ? 'text-orange-500' : 'text-ai';
                const typeColor = isCorrection ? 'bg-orange-100 text-orange-700' : 'bg-ai/10 text-ai';
                
                return `
                <div class="border rounded-lg p-4 hover:shadow-md transition-all duration-200 ${bgClass} ${isCorrection ? 'shadow-sm' : ''}">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${typeColor}">
                                <i class="fas ${iconClass} mr-1 ${iconColor}"></i>
                                ${feature.type}
                                ${isCorrection ? '<span class="ml-1 text-xs">ğŸ”¥</span>' : ''}
                            </span>
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700">
                                ç½®ä¿¡åº¦: ${feature.confidence}
                            </span>
                            ${isCorrection ? '<span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-700"><i class="fas fa-star mr-1"></i>AIçº é”™</span>' : ''}
                        </div>
                        <div class="flex items-center space-x-3">
                            <span class="text-xs text-gray-500">${feature.time}</span>
                            <button onclick="showTrustedFeatureModal(${JSON.stringify(feature).replace(/"/g, '&quot;')})" class="text-ai hover:text-purple-700 text-xs">ä¼˜åŒ–</button>
                            <button onclick="deleteTrustedFeature(${feature.id})" class="text-red-600 hover:text-red-800 text-xs">åˆ é™¤</button>
                        </div>
                    </div>
                    <div class="font-mono text-sm text-gray-800 mb-3 bg-white p-2 rounded border">${feature.content}</div>
                    <div class="grid grid-cols-2 gap-3 text-sm">
                        <div>
                            <span class="text-gray-500">å­¦ä¹ æ–¹å¼:</span>
                            <span class="text-gray-700 font-medium">${feature.learningMethod}</span>
                        </div>
                        <div>
                            <span class="text-gray-500">å…³è”äº‹ä»¶:</span>
                            <span class="text-blue-600 font-medium">${feature.relatedEvents} ä¸ª</span>
                        </div>
                        <div>
                            <span class="text-gray-500">æ•°æ®æº:</span>
                            <span class="text-gray-700">${feature.source}</span>
                        </div>
                        <div>
                            <span class="text-gray-500">æ•ˆæœæå‡:</span>
                            <span class="text-green-600 font-bold">${feature.effectiveness}</span>
                        </div>
                    </div>
                    <div class="mt-3 pt-3 border-t border-gray-100">
                        <span class="text-xs text-gray-500">${feature.marker}</span>
                    </div>
                </div>
                `;
            }).join('');
        }



        // åˆå§‹åŒ–æœ€è¿‘å­¦ä¹ è®°å½•
        function initializeRecentLearning() {
            const container = document.getElementById('recent-learning-list');
            container.innerHTML = learningRecords.map(record => `
                <div class="flex items-start space-x-3 p-3 border ${record.highlight ? 'border-orange-200 bg-orange-50' : 'border-gray-200'} rounded-lg hover:bg-gray-50 ${record.highlight ? 'shadow-md' : ''}">
                    <div class="w-8 h-8 flex items-center justify-center rounded-full ${record.highlight ? 'bg-orange-100' : 'bg-gray-100'}">
                        <i class="fas ${record.icon} ${record.color}"></i>
                    </div>
                    <div class="flex-1">
                        <div class="text-sm font-medium text-gray-800 flex items-center">
                            ${record.type}
                            ${record.highlight ? '<span class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-700"><i class="fas fa-star mr-1"></i>é‡è¦</span>' : ''}
                        </div>
                        <div class="text-sm text-gray-600">${record.content}</div>
                        <div class="text-xs text-gray-500 mt-1">${record.time}</div>
                    </div>
                </div>
            `).join('');
        }

        // åˆå§‹åŒ–AIæ™ºèƒ½è§„åˆ™å¼•æ“
        function initializeCustomRules() {
            const rules = [
                {
                    name: 'å†…ç½‘æ‰«ææ™ºèƒ½è¯†åˆ«',
                    condition: 'æ¥æºIPåœ¨192.168.1.0/24ä¸”ç›®æ ‡ç«¯å£ä¸º22',
                    action: 'åŠ¨æ€é£é™©è¯„ä¼°',
                    status: 'å­¦ä¹ ä¸­',
                    confidence: '94%',
                    aiGenerated: true,
                    performance: '+32%',
                    adaptations: 5,
                    lastOptimized: '2å°æ—¶å‰'
                },
                {
                    name: 'ä¸šåŠ¡å¥åº·æ£€æŸ¥ä¼˜åŒ–',
                    condition: 'User-AgentåŒ¹é…å¥åº·æ£€æŸ¥æ¨¡å¼',
                    action: 'AIä¸Šä¸‹æ–‡åˆ†æ',
                    status: 'å·²ä¼˜åŒ–',
                    confidence: '97%',
                    aiGenerated: false,
                    performance: '+45%',
                    adaptations: 12,
                    lastOptimized: '30åˆ†é’Ÿå‰'
                },
                {
                    name: 'ä¾›åº”é“¾æµé‡æ¨¡å¼',
                    condition: 'APIè°ƒç”¨é¢‘ç‡å¼‚å¸¸æ£€æµ‹',
                    action: 'AIè¡Œä¸ºåŸºçº¿å¯¹æ¯”',
                    status: 'è‡ªé€‚åº”',
                    confidence: '89%',
                    aiGenerated: true,
                    performance: '+28%',
                    adaptations: 8,
                    lastOptimized: '1å°æ—¶å‰'
                }
            ];

            const container = document.getElementById('custom-rules-list');
            container.innerHTML = rules.map(rule => `
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-all duration-200 bg-gradient-to-r from-white to-blue-50">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <h4 class="font-medium text-gray-800">${rule.name}</h4>
                            ${rule.aiGenerated ? '<span class="inline-flex items-center px-2 py-1 rounded text-xs bg-ai text-white"><i class="fas fa-robot mr-1"></i>AIç”Ÿæˆ</span>' : ''}
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${rule.status === 'å­¦ä¹ ä¸­' ? 'bg-yellow-100 text-yellow-700' : rule.status === 'å·²ä¼˜åŒ–' ? 'bg-green-100 text-green-700' : 'bg-blue-100 text-blue-700'}">
                                ${rule.status}
                            </span>
                            <span class="text-xs text-gray-500">ç½®ä¿¡åº¦: ${rule.confidence}</span>
                        </div>
                    </div>
                    <div class="space-y-2 mb-3">
                        <div class="text-sm">
                            <span class="text-gray-500">æ¡ä»¶:</span>
                            <span class="text-gray-700">${rule.condition}</span>
                        </div>
                        <div class="text-sm">
                            <span class="text-gray-500">åŠ¨ä½œ:</span>
                            <span class="text-gray-700">${rule.action}</span>
                        </div>
                    </div>
                    <div class="grid grid-cols-3 gap-3 text-sm bg-white/50 rounded p-2">
                        <div class="text-center">
                            <div class="text-green-600 font-bold">${rule.performance}</div>
                            <div class="text-xs text-gray-500">æ€§èƒ½æå‡</div>
                        </div>
                        <div class="text-center">
                            <div class="text-blue-600 font-bold">${rule.adaptations}</div>
                            <div class="text-xs text-gray-500">è‡ªé€‚åº”æ¬¡æ•°</div>
                        </div>
                        <div class="text-center">
                            <div class="text-gray-600 font-bold">${rule.lastOptimized}</div>
                            <div class="text-xs text-gray-500">æœ€è¿‘ä¼˜åŒ–</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }



        // è®¾ç½®æ–‡æœ¬é€‰æ‹©åŠŸèƒ½
        function setupTextSelection() {
            document.addEventListener('mouseup', function(e) {
                // ç­‰å¾…ä¸€ä¸ªçŸ­æš‚å»¶è¿Ÿä»¥ç¡®ä¿é€‰æ‹©å·²å®Œæˆ
                setTimeout(() => {
                    const selection = window.getSelection();
                    const selectedText = selection.toString().trim();
                    
                    if (selectedText.length > 0) {
                        const range = selection.getRangeAt(0);
                        const rect = range.getBoundingClientRect();
                        
                        const toolbar = document.getElementById('floating-toolbar');
                        
                        // æ”¹è¿›å®šä½è®¡ç®—ï¼Œè€ƒè™‘é¡µé¢æ»šåŠ¨
                        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                        const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;
                        
                        toolbar.style.left = (rect.left + scrollLeft) + 'px';
                        toolbar.style.top = (rect.top + scrollTop - 60) + 'px';
                        toolbar.classList.remove('hidden');
                        
                        // å­˜å‚¨é€‰ä¸­çš„æ–‡æœ¬
                        toolbar.dataset.selectedText = selectedText;
                        
                        // æ›´æ–°é¢„è§ˆæ–‡æœ¬
                        const preview = document.getElementById('selected-text-preview');
                        if (preview) {
                            preview.textContent = selectedText.length > 20 ? selectedText.substring(0, 20) + '...' : selectedText;
                        }
                        
                        console.log('æ–‡æœ¬å·²é€‰æ‹©:', selectedText); // è°ƒè¯•ä¿¡æ¯
                        
                        // æ˜¾ç¤ºæˆåŠŸæç¤º
                        if (selectedText.includes('HealthChecker')) {
                            showNotification('æ–‡æœ¬é€‰æ‹©æˆåŠŸï¼è¯·ç‚¹å‡»"æ ‡è®°ä¸ºè‰¯æ€§"æŒ‰é’®', 'success');
                        }
                    } else {
                        // å¦‚æœæ²¡æœ‰é€‰ä¸­æ–‡æœ¬ï¼Œéšè—å·¥å…·æ¡
                        document.getElementById('floating-toolbar').classList.add('hidden');
                    }
                }, 10);
            });

            // ç‚¹å‡»å…¶ä»–åœ°æ–¹æ—¶éšè—å·¥å…·æ¡
            document.addEventListener('click', function(e) {
                if (!e.target.closest('#floating-toolbar')) {
                    const selection = window.getSelection();
                    if (selection.toString().trim().length === 0) {
                        document.getElementById('floating-toolbar').classList.add('hidden');
                    }
                }
            });

            // é”®ç›˜æ“ä½œæ”¯æŒ
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    document.getElementById('floating-toolbar').classList.add('hidden');
                    window.getSelection().removeAllRanges();
                }
            });
        }

        // æ ‡è®°ä¸ºè‰¯æ€§
        function markAsGood() {
            const toolbar = document.getElementById('floating-toolbar');
            const selectedText = toolbar.dataset.selectedText;
            
            showLearningModal('good', selectedText);
            toolbar.classList.add('hidden');
        }

        // æ ‡è®°ä¸ºå¨èƒ
        function markAsThreat() {
            const toolbar = document.getElementById('floating-toolbar');
            const selectedText = toolbar.dataset.selectedText;
            
            showLearningModal('threat', selectedText);
            toolbar.classList.add('hidden');
        }

        // å…¨å±€æœç´¢
        function globalSearch() {
            const toolbar = document.getElementById('floating-toolbar');
            const selectedText = toolbar.dataset.selectedText;
            
            showNotification(`æœç´¢ "${selectedText}" çš„ç›¸å…³ä¿¡æ¯...`, 'info');
            toolbar.classList.add('hidden');
        }

        // æ˜¾ç¤ºå­¦ä¹ æ¨¡æ€æ¡†
        function showLearningModal(type, text) {
            const modal = document.getElementById('learning-modal');
            const content = document.getElementById('learning-modal-content');
            
            if (type === 'good') {
                content.innerHTML = `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">ç‰¹å¾å†…å®¹</label>
                            <input type="text" value="${text}" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">AIå­¦ä¹ ç±»å‹</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <option>è‰¯æ€§æ¨¡å¼è¯†åˆ«</option>
                                <option>è¿ç»´è¡Œä¸ºæ¨¡å¼</option>
                                <option>å†…éƒ¨åŸŸåæ¨¡å¼</option>
                                <option>GPTç ”åˆ¤ä¼˜åŒ–</option>
                                <option>ä¸šåŠ¡ç‰¹å¾æ¨¡å¼</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">å¿½ç•¥èŒƒå›´</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <option>å…¨å±€å¿½ç•¥</option>
                                <option>ä»…åœ¨Webæ”»å‡»å‘Šè­¦ä¸­å¿½ç•¥</option>
                                <option>ä»…åœ¨SQLæ³¨å…¥å‘Šè­¦ä¸­å¿½ç•¥</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">å¤‡æ³¨</label>
                            <textarea placeholder="å†…éƒ¨ä¸šåŠ¡å¥åº·æ£€æŸ¥æ¢é’ˆ" class="w-full px-3 py-2 border border-gray-300 rounded-lg h-20 resize-none"></textarea>
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="confirmLearning('good')" class="flex-1 bg-success text-white py-2 rounded-lg hover:bg-green-700">
                                ç¡®è®¤ï¼Œä¸å†å‘Šè­¦
                            </button>
                            <button onclick="closeLearningModal()" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                                å–æ¶ˆ
                            </button>
                        </div>
                    </div>
                `;
            }
            
            modal.classList.remove('hidden');
        }

        // å…³é—­å­¦ä¹ æ¨¡æ€æ¡†
        function closeLearningModal() {
            document.getElementById('learning-modal').classList.add('hidden');
        }

        // ç¡®è®¤å­¦ä¹ 
        function confirmLearning(type) {
            showNotification('å­¦ä¹ æˆåŠŸï¼AIå·²è®°ä½è¿™ä¸ªç‰¹å¾', 'success');
            closeLearningModal();
            
            // åˆ·æ–°ç›¸å…³æ•°æ®
            setTimeout(() => {
                initializeTrustedFeatures();
                initializeRecentLearning();
            }, 500);
        }

        // æ•™AIåŠŸèƒ½ - ç‚¹å‡»IPåœ°å€æ—¶è°ƒç”¨
        function teachAI(type, value) {
            if (type === 'ip') {
                showIPLearningModal(value);
            }
        }

        // æ˜¾ç¤ºIPå­¦ä¹ æ¨¡æ€æ¡†
        function showIPLearningModal(ip) {
            const modal = document.getElementById('learning-modal');
            const content = document.getElementById('learning-modal-content');
            
            content.innerHTML = `
                <div class="space-y-4">
                    <div class="text-center mb-4">
                        <div class="w-16 h-16 bg-ai/10 rounded-full flex items-center justify-center mx-auto mb-3">
                            <i class="fas fa-brain text-ai text-2xl"></i>
                        </div>
                        <h4 class="text-lg font-semibold text-gray-800">æ•™AIå­¦ä¹ èµ„äº§ä¿¡æ¯</h4>
                        <p class="text-sm text-gray-600">ä¸º <code class="bg-gray-100 px-2 py-1 rounded">${ip}</code> æ·»åŠ èµ„äº§å±æ€§</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">èµ„äº§æ ‡ç­¾</label>
                        <input type="text" id="ip-tags" placeholder="ä¾‹å¦‚: è‡ªåŠ¨åŒ–è¿ç»´å¹³å°, å†…éƒ¨å·¥å…·" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                        <p class="text-xs text-gray-500 mt-1">å¤šä¸ªæ ‡ç­¾ç”¨é€—å·åˆ†éš”</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ä¸šåŠ¡å½’å±</label>
                        <input type="text" id="ip-business" placeholder="ä¾‹å¦‚: è¿ç»´éƒ¨" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">è¡¥å……è¯´æ˜</label>
                        <textarea id="ip-description" placeholder="ä¾‹å¦‚: Ansibleè‡ªåŠ¨åŒ–å¹³å°ï¼Œä¼šæœ‰å¤§é‡SSHç™»å½•ï¼Œå±æ­£å¸¸è¡Œä¸º" 
                                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai h-20 resize-none"></textarea>
                    </div>
                    <div class="flex space-x-3">
                        <button onclick="saveIPLearning('${ip}')" 
                                class="flex-1 bg-ai text-white py-2 rounded-lg hover:bg-purple-700">
                            <i class="fas fa-brain mr-2"></i>å¥½çš„ï¼ŒAIè®°ä½äº†
                        </button>
                        <button onclick="closeLearningModal()" 
                                class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                            å–æ¶ˆ
                        </button>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // ä¿å­˜IPå­¦ä¹ 
        function saveIPLearning(ip) {
            const tags = document.getElementById('ip-tags').value.split(',').map(tag => tag.trim()).filter(tag => tag);
            const business = document.getElementById('ip-business').value.trim();
            const description = document.getElementById('ip-description').value.trim();
            
            if (tags.length === 0) {
                showNotification('è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªèµ„äº§æ ‡ç­¾', 'error');
                return;
            }
            
            // æ·»åŠ åˆ°èµ„äº§çŸ¥è¯†åº“
            const newAsset = {
                id: Date.now(),
                entity: ip,
                tags: tags,
                business: business || 'æœªçŸ¥',
                source: 'åœ¨åœºå­¦ä¹ è·å¾—',
                time: new Date().toLocaleString('zh-CN'),
                description: description
            };
            
            assetKnowledgeData.push(newAsset);
            
            // æ·»åŠ åˆ°å­¦ä¹ è®°å½•
            addLearningRecord('èµ„äº§æ ‡è®°', `${ip} â†’ ${tags.join(', ')}`);
            
            showNotification('å­¦ä¹ æˆåŠŸï¼AIå·²è®°ä½è¿™ä¸ªèµ„äº§', 'success');
            closeLearningModal();
            renderAssetKnowledgeList();
            updateStatistics();
        }

        // å­¦ä¹ è®°å½•æ•°æ®å­˜å‚¨
        let learningRecords = [
            {
                id: 1,
                type: 'AIçº é”™',
                content: 'çº æ­£æœå°‘å¯¹192.168.50.98çš„è¯¯åˆ¤ â†’ æ”¹ä¸º"æ¼æ‰«æœåŠ¡å™¨"',
                time: '2åˆ†é’Ÿå‰',
                icon: 'fa-exclamation-triangle',
                color: 'text-orange-500',
                highlight: true
            },
            {
                id: 2,
                type: 'AIä¼˜åŒ–',
                content: 'GPTæ¨¡å‹è°ƒä¼˜ â†’ SQLæ³¨å…¥æ£€æµ‹å‡†ç¡®ç‡æå‡12%',
                time: '8åˆ†é’Ÿå‰',
                icon: 'fa-brain',
                color: 'text-purple-500'
            },
            {
                id: 3,
                type: 'AIçº é”™',
                content: 'çº æ­£æœå°‘å¯¹"Python-requests"çš„å¨èƒåˆ¤æ–­',
                time: '1å°æ—¶å‰',
                icon: 'fa-sync-alt',
                color: 'text-red-500',
                highlight: true
            },
            {
                id: 4,
                type: 'æ™ºèƒ½å‘ç°',
                content: 'AIè¯†åˆ«å‡ºä»£ç†æœåŠ¡å™¨10.20.100.5çš„è¡Œä¸ºç‰¹å¾',
                time: '2å°æ—¶å‰',
                icon: 'fa-search',
                color: 'text-blue-500'
            },
            {
                id: 5,
                type: 'AIçº é”™',
                content: 'çº æ­£æœå°‘å¯¹å†…ç½‘æ‰«æçš„è¯¯æŠ¥åˆ¤æ–­ â†’ é™ä½15%è¯¯æŠ¥',
                time: '3å°æ—¶å‰',
                icon: 'fa-check-circle',
                color: 'text-green-500',
                highlight: true
            },
            {
                id: 6,
                type: 'ç‰¹å¾å­¦ä¹ ',
                content: 'HealthChecker/1.0 â†’ æ ‡è®°ä¸ºè‰¯æ€§ç‰¹å¾',
                time: 'æ˜¨å¤©',
                icon: 'fa-check-shield',
                color: 'text-success'
            }
        ];

        // æ·»åŠ å­¦ä¹ è®°å½•
        function addLearningRecord(type, content) {
            const icons = {
                'èµ„äº§æ ‡è®°': 'fa-server',
                'ç‰¹å¾æ ‡è®°': 'fa-check-shield',
                'GPTè°ƒä¼˜': 'fa-brain',
                'è§„åˆ™å®šä¹‰': 'fa-code-branch'
            };
            
            const colors = {
                'èµ„äº§æ ‡è®°': 'text-ai',
                'ç‰¹å¾æ ‡è®°': 'text-success',
                'GPTè°ƒä¼˜': 'text-ai',
                'è§„åˆ™å®šä¹‰': 'text-warning'
            };
            
            const newRecord = {
                id: Date.now(),
                type,
                content,
                time: 'åˆšåˆš',
                icon: icons[type] || 'fa-lightbulb',
                color: colors[type] || 'text-gray-600'
            };
            
            learningRecords.unshift(newRecord); // æ·»åŠ åˆ°å¼€å¤´
            if (learningRecords.length > 10) {
                learningRecords = learningRecords.slice(0, 10); // åªä¿ç•™æœ€è¿‘10æ¡
            }
            
            // é‡æ–°æ¸²æŸ“å­¦ä¹ è®°å½•
            const container = document.getElementById('recent-learning-list');
            container.innerHTML = learningRecords.map(record => `
                <div class="flex items-start space-x-3 p-3 border ${record.highlight ? 'border-orange-200 bg-orange-50' : 'border-gray-200'} rounded-lg hover:bg-gray-50 ${record.highlight ? 'shadow-md' : ''}">
                    <div class="w-8 h-8 flex items-center justify-center rounded-full ${record.highlight ? 'bg-orange-100' : 'bg-gray-100'}">
                        <i class="fas ${record.icon} ${record.color}"></i>
                    </div>
                    <div class="flex-1">
                        <div class="text-sm font-medium text-gray-800 flex items-center">
                            ${record.type}
                            ${record.highlight ? '<span class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-700"><i class="fas fa-star mr-1"></i>é‡è¦</span>' : ''}
                        </div>
                        <div class="text-sm text-gray-600">${record.content}</div>
                        <div class="text-xs text-gray-500 mt-1">${record.time}</div>
                    </div>
                </div>
            `).join('');
        }

        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        function updateStatistics() {
            // æ›´æ–°æ€»çŸ¥è¯†é¡¹
            const totalKnowledge = assetKnowledgeData.length + trustedFeatures.length;
            
            // æ›´æ–°é¡µé¢å¤´éƒ¨ç»Ÿè®¡
            const statElements = document.querySelectorAll('.text-2xl.font-bold');
            if (statElements.length >= 4) {
                statElements[0].textContent = totalKnowledge;
                statElements[1].textContent = assetKnowledgeData.length;
                statElements[2].textContent = trustedFeatures.length;
                // ç¬¬4ä¸ªä¿æŒä¸ºå‡†ç¡®ç‡ä¸å˜
            }
        }

        // åˆå§‹åŒ–AIæ™ºèƒ½å»ºè®®
        function initializeAISuggestions() {
            const suggestions = [
                {
                    type: 'network-discovery',
                    title: 'AIå‘ç°æ–°çš„ç½‘æ®µæ¨¡å¼',
                    description: 'åŸºäºæµé‡åˆ†æï¼Œå‘ç°172.20.0.0/16å¯èƒ½æ˜¯æ•°æ®åº“ä¸“ç”¨ç½‘æ®µ',
                    confidence: '89%',
                    action: 'æ·»åŠ ä¸ºå·²çŸ¥ç½‘æ®µ',
                    icon: 'fa-network-wired',
                    color: 'text-blue-500',
                    priority: 'high',
                    detailInfo: {
                        networkRange: '172.20.0.0/16',
                        analysis: 'è¯¥ç½‘æ®µæµé‡æ¨¡å¼æ˜¾ç¤ºå…¸å‹çš„æ•°æ®åº“è®¿é—®ç‰¹å¾',
                        suggestedTags: ['æ•°æ®åº“ç½‘æ®µ', 'é«˜æ•æ„Ÿåº¦'],
                        riskLevel: 'é«˜'
                    }
                },
                {
                    type: 'asset-discovery',
                    title: 'å‘ç°æ–°çš„ä»£ç†æœåŠ¡å™¨',
                    description: '192.168.100.88 è¡¨ç°å‡ºä»£ç†æœåŠ¡å™¨è¡Œä¸ºç‰¹å¾ï¼Œéœ€è¦ç”¨æˆ·ç¡®è®¤',
                    confidence: '92%',
                    action: 'ç¡®è®¤å¹¶æ ‡è®°',
                    icon: 'fa-server',
                    color: 'text-green-500',
                    priority: 'high',
                    detailInfo: {
                        assetIP: '192.168.100.88',
                        behaviorPattern: 'å¤§é‡è½¬å‘è¯·æ±‚ï¼Œç«¯å£8080å¼€æ”¾',
                        suggestedTags: ['ä»£ç†æœåŠ¡å™¨', 'ç½‘ç»œè®¾å¤‡'],
                        department: 'ç½‘ç»œè¿ç»´éƒ¨'
                    }
                },
                {
                    type: 'asset-discovery',
                    title: 'è¯†åˆ«ç–‘ä¼¼æ¼æ‰«è®¾å¤‡',
                    description: '10.50.30.15 å…·æœ‰æ¼æ´æ‰«æå™¨è¡Œä¸ºç‰¹å¾ï¼Œå»ºè®®ç¡®è®¤å½’å±',
                    confidence: '87%',
                    action: 'ç¡®è®¤è®¾å¤‡ç±»å‹',
                    icon: 'fa-search',
                    color: 'text-purple-500',
                    priority: 'medium',
                    detailInfo: {
                        assetIP: '10.50.30.15',
                        behaviorPattern: 'å¯¹å¤šä¸ªç«¯å£è¿›è¡Œæ‰«æï¼ŒUser-AgentåŒ…å«å®‰å…¨å·¥å…·ç‰¹å¾',
                        suggestedTags: ['æ¼æ‰«æœåŠ¡å™¨', 'å®‰å…¨è®¾å¤‡'],
                        scanPorts: '22, 80, 443, 3389, 8080'
                    }
                }
            ];

            const container = document.getElementById('ai-suggestions');
            container.innerHTML = suggestions.map(suggestion => {
                const bgClass = suggestion.priority === 'high' ? 'bg-gradient-to-r from-white to-purple-50' : 
                               suggestion.priority === 'medium' ? 'bg-gradient-to-r from-white to-blue-50' : 
                               'bg-gradient-to-r from-white to-gray-50';
                
                const iconBgClass = suggestion.priority === 'high' ? 'bg-purple-100' : 
                                   suggestion.priority === 'medium' ? 'bg-blue-100' : 
                                   'bg-gray-100';
                
                const priorityBadgeClass = suggestion.priority === 'high' ? 'bg-red-100 text-red-700' : 
                                          suggestion.priority === 'medium' ? 'bg-yellow-100 text-yellow-700' : 
                                          'bg-gray-100 text-gray-700';
                
                const priorityText = suggestion.priority === 'high' ? 'é«˜ä¼˜å…ˆçº§' : 
                                    suggestion.priority === 'medium' ? 'ä¸­ä¼˜å…ˆçº§' : 
                                    'ä½ä¼˜å…ˆçº§';
                
                return `
                    <div class="border border-gray-200 rounded-lg p-4 hover:shadow-lg transition-all duration-300 ${bgClass} hover:scale-105">
                        <div class="flex items-start space-x-4">
                            <div class="w-12 h-12 rounded-lg flex items-center justify-center ${iconBgClass}">
                                <i class="fas ${suggestion.icon} ${suggestion.color} text-lg"></i>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between mb-2">
                                    <h4 class="font-semibold text-gray-900">${suggestion.title}</h4>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${priorityBadgeClass}">
                                            ${priorityText}
                                        </span>
                                        <span class="text-xs bg-ai text-white px-2 py-1 rounded-full">ç½®ä¿¡åº¦: ${suggestion.confidence}</span>
                                    </div>
                                </div>
                                <p class="text-sm text-gray-700 mb-4 leading-relaxed">${suggestion.description}</p>
                                <div class="flex items-center justify-between">
                                    <button onclick="applySuggestion('${suggestion.type}', '${suggestion.title}')" class="flex items-center space-x-2 bg-gradient-to-r from-purple-500 to-blue-500 text-white px-4 py-2 rounded-lg text-sm hover:from-purple-600 hover:to-blue-600 transition-all transform hover:scale-105">
                                        <i class="fas fa-robot"></i>
                                        <span>${suggestion.action}</span>
                                    </button>
                                    <div class="flex items-center space-x-2">
                                        <button onclick="showSuggestionDetail(${JSON.stringify(suggestion).replace(/"/g, '&quot;')})" class="text-blue-600 hover:text-blue-800 text-sm px-3 py-1 rounded bg-blue-50 hover:bg-blue-100 transition-colors border border-blue-200">
                                            <i class="fas fa-info-circle mr-1"></i>
                                            è¯¦æƒ…
                                        </button>
                                        <button onclick="ignoreSuggestion('${suggestion.type}')" class="text-gray-500 hover:text-red-600 text-sm px-2 py-1 rounded hover:bg-red-50 transition-colors">
                                            <i class="fas fa-times mr-1"></i>
                                            å¿½ç•¥
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // æ·»åŠ è‡ªå®šä¹‰è§„åˆ™
        function addCustomRule() {
            showNotification('è‡ªå®šä¹‰è§„åˆ™åŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼', 'info');
        }

        // æ˜¾ç¤ºå»ºè®®è¯¦æƒ…
        function showSuggestionDetail(suggestion) {
            const modal = document.getElementById('learning-modal');
            const content = document.getElementById('learning-modal-content');
            
            let detailHTML = '';
            
            if (suggestion.type === 'network-discovery') {
                detailHTML = `
                    <div class="space-y-4">
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-network-wired text-blue-600"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">${suggestion.title}</h3>
                                <p class="text-sm text-gray-600">ç½®ä¿¡åº¦: ${suggestion.confidence}</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-medium text-gray-800 mb-3">ç½‘æ®µåˆ†æè¯¦æƒ…</h4>
                            <div class="grid grid-cols-2 gap-3 text-sm">
                                <div>
                                    <span class="text-gray-600">ç½‘æ®µèŒƒå›´ï¼š</span>
                                    <span class="font-mono text-blue-600">${suggestion.detailInfo.networkRange}</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">é£é™©ç­‰çº§ï¼š</span>
                                    <span class="text-red-600 font-medium">${suggestion.detailInfo.riskLevel}</span>
                                </div>
                                <div class="col-span-2">
                                    <span class="text-gray-600">åˆ†æç»“æœï¼š</span>
                                    <p class="text-gray-800 mt-1">${suggestion.detailInfo.analysis}</p>
                                </div>
                                <div class="col-span-2">
                                    <span class="text-gray-600">å»ºè®®æ ‡ç­¾ï¼š</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${suggestion.detailInfo.suggestedTags.map(tag => 
                                            `<span class="inline-flex items-center px-2 py-1 rounded text-xs bg-blue-100 text-blue-700">${tag}</span>`
                                        ).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (suggestion.type === 'asset-discovery') {
                detailHTML = `
                    <div class="space-y-4">
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                                <i class="fas ${suggestion.icon} ${suggestion.color}"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">${suggestion.title}</h3>
                                <p class="text-sm text-gray-600">ç½®ä¿¡åº¦: ${suggestion.confidence}</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-medium text-gray-800 mb-3">èµ„äº§åˆ†æè¯¦æƒ…</h4>
                            <div class="grid grid-cols-1 gap-3 text-sm">
                                <div>
                                    <span class="text-gray-600">èµ„äº§IPï¼š</span>
                                    <span class="font-mono text-blue-600">${suggestion.detailInfo.assetIP}</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">è¡Œä¸ºæ¨¡å¼ï¼š</span>
                                    <p class="text-gray-800 mt-1">${suggestion.detailInfo.behaviorPattern}</p>
                                </div>
                                ${suggestion.detailInfo.scanPorts ? `
                                <div>
                                    <span class="text-gray-600">æ‰«æç«¯å£ï¼š</span>
                                    <span class="font-mono text-gray-800">${suggestion.detailInfo.scanPorts}</span>
                                </div>
                                ` : ''}
                                <div>
                                    <span class="text-gray-600">å»ºè®®å½’å±ï¼š</span>
                                    <span class="text-gray-800">${suggestion.detailInfo.department || 'å¾…ç¡®è®¤'}</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">å»ºè®®æ ‡ç­¾ï¼š</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${suggestion.detailInfo.suggestedTags.map(tag => 
                                            `<span class="inline-flex items-center px-2 py-1 rounded text-xs bg-purple-100 text-purple-700">${tag}</span>`
                                        ).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            content.innerHTML = detailHTML + `
                <div class="flex space-x-3 mt-6">
                    <button onclick="applySuggestion('${suggestion.type}', '${suggestion.title}')" 
                            class="flex-1 bg-gradient-to-r from-purple-500 to-blue-500 text-white py-2 rounded-lg hover:from-purple-600 hover:to-blue-600">
                        ${suggestion.action}
                    </button>
                    <button onclick="closeLearningModal()" 
                            class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                        å…³é—­
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // åº”ç”¨å»ºè®®
        function applySuggestion(type, title) {
            if (type === 'network-discovery') {
                showNotification('å·²å°†ç½‘æ®µä¿¡æ¯æ·»åŠ åˆ°èµ„äº§çŸ¥è¯†åº“', 'success');
                // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„ç½‘æ®µæ·»åŠ é€»è¾‘
            } else if (type === 'asset-discovery') {
                showNotification('å·²ç¡®è®¤èµ„äº§ç±»å‹å¹¶æ·»åŠ åˆ°çŸ¥è¯†åº“', 'success');
                // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„èµ„äº§æ·»åŠ é€»è¾‘
            }
            closeLearningModal();
        }

        // å¿½ç•¥å»ºè®®
        function ignoreSuggestion(type) {
            showNotification('å·²å¿½ç•¥è¯¥å»ºè®®', 'info');
            // è¿™é‡Œå¯ä»¥æ·»åŠ ä»å»ºè®®åˆ—è¡¨ä¸­ç§»é™¤çš„é€»è¾‘
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                warning: 'bg-yellow-500',
                info: 'bg-blue-500'
            };
            
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // CSS æ ·å¼
        const style = document.createElement('style');
        style.textContent = `
            .tab-btn {
                padding: 0.75rem 1.5rem;
                border-radius: 0.5rem;
                color: #6b7280;
                background: transparent;
                border: none;
                cursor: pointer;
                transition: all 0.2s ease;
                font-weight: 500;
            }
            .tab-btn:hover {
                color: #8b5cf6;
                background: #f3f4f6;
            }
            .tab-btn.active {
                color: #8b5cf6;
                background: #f3f0ff;
                border: 1px solid #e0e7ff;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html> 