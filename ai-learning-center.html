<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI学习中心 - XDR智能运营系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e40af',
                        secondary: '#64748b',
                        accent: '#3b82f6',
                        success: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444',
                        ai: '#8b5cf6',
                        learning: '#06b6d4'
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'bounce-subtle': 'bounceSubtle 0.6s ease-in-out',
                        'glow': 'glow 2s ease-in-out infinite alternate'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes bounceSubtle {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes glow {
            from { box-shadow: 0 0 10px rgba(139, 92, 246, 0.3); }
            to { box-shadow: 0 0 20px rgba(139, 92, 246, 0.6); }
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .learning-badge {
            background: linear-gradient(135deg, #8b5cf6, #06b6d4);
        }
        .knowledge-item:hover .teach-ai-btn {
            opacity: 1;
        }
        .teach-ai-btn {
            opacity: 0;
            transition: opacity 0.2s ease;
        }
        .floating-toolbar {
            background: linear-gradient(135deg, #8b5cf6, #06b6d4);
            box-shadow: 0 4px 20px rgba(139, 92, 246, 0.3);
            animation: fadeInScale 0.2s ease-out;
            border: 2px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        @keyframes fadeInScale {
            from { 
                opacity: 0; 
                transform: scale(0.8) translateY(10px); 
            }
            to { 
                opacity: 1; 
                transform: scale(1) translateY(0); 
            }
        }
        .selectable-text {
            user-select: text;
            cursor: text;
        }
        .selectable-text::selection {
            background: rgba(139, 92, 246, 0.3);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- 页面标题区域 -->
    <div class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 bg-gradient-to-r from-ai to-learning rounded-xl flex items-center justify-center">
                        <i class="fas fa-brain text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">AI学习中心</h1>
                        <p class="text-sm text-gray-600">让AI学习您的业务知识，提供个性化安全分析</p>
                    </div>
                </div>
                <div class="flex items-center space-x-3">
                    <div class="text-sm text-gray-500">
                        <i class="fas fa-database mr-1"></i>
                        已学习知识项: <span class="font-bold text-ai">156</span>
                    </div>
                    <div class="text-sm text-gray-500">
                        <i class="fas fa-lightbulb mr-1"></i>
                        今日新增: <span class="font-bold text-learning">8</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 主要内容区域 -->
    <div class="max-w-7xl mx-auto px-6 py-6">
        <!-- 导航标签页 -->
        <div class="mb-6">
            <nav class="flex space-x-8">
                <button class="tab-btn" data-tab="context">
                    <i class="fas fa-hand-pointer mr-2"></i>
                    AI互动调优演示
                </button>
                <button class="tab-btn active" data-tab="assets">
                    <i class="fas fa-server mr-2"></i>
                    资产学习中心
                </button>
                <button class="tab-btn" data-tab="judgment">
                    <i class="fas fa-gavel mr-2"></i>
                    研判知识库
                </button>
                <button class="tab-btn" data-tab="disposal">
                    <i class="fas fa-tasks mr-2"></i>
                    处置知识库
                </button>
                <button class="tab-btn" data-tab="analytics">
                    <i class="fas fa-chart-line mr-2"></i>
                    学习统计
                </button>
            </nav>
        </div>

        <!-- 资产学习中心 -->
        <div id="assets-tab" class="tab-content">
            <div class="space-y-6">
                <!-- 资产知识列表 -->
                <div>
                    <div class="bg-white rounded-lg shadow-sm border card-hover">
                        <div class="p-6 border-b border-gray-200">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-semibold text-gray-900">
                                    <i class="fas fa-list-ul text-ai mr-2"></i>
                                    资产知识列表
                                </h3>
                                <button onclick="addAssetKnowledge()" class="bg-ai text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors">
                                    <i class="fas fa-plus mr-2"></i>
                                    新增资产知识
                                </button>
                            </div>
                            <div class="mt-4 flex space-x-4">
                                <input type="text" id="asset-search" placeholder="搜索IP、标签或业务归属..." 
                                       oninput="searchAssetKnowledge()"
                                       class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai focus:border-transparent">
                                <select id="asset-filter" onchange="filterAssetKnowledge()" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                                    <option value="">全部类型</option>
                                    <option value="服务器">服务器</option>
                                    <option value="网络设备">网络设备</option>
                                    <option value="安全设备">安全设备</option>
                                    <option value="业务系统">业务系统</option>
                                </select>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">实体</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">资产标签</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">业务归属</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">学习来源</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="asset-knowledge-list">
                                    <!-- 动态生成的资产知识条目 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- AI智能建议 -->
                <div>
                    <div class="bg-white rounded-lg shadow-sm border card-hover">
                        <div class="p-6 border-b border-gray-200">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-900">
                                        <i class="fas fa-robot text-ai mr-2"></i>
                                        AI智能建议
                                    </h3>
                                    <p class="text-sm text-gray-600 mt-1">基于流量分析和行为模式的智能发现</p>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-ai rounded-full animate-pulse"></div>
                                    <span class="text-xs text-ai font-medium">实时分析中</span>
                                </div>
                            </div>
                        </div>
                        <div class="p-6" id="ai-suggestions">
                            <!-- AI建议内容 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 研判知识库 -->
        <div id="judgment-tab" class="tab-content hidden">
            <div class="max-w-4xl mx-auto">
                <!-- AI智能规则引擎 -->
                <div class="bg-white rounded-lg shadow-sm border card-hover">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">
                                    <i class="fas fa-atom text-ai mr-2"></i>
                                    AI智能规则引擎
                                </h3>
                                <p class="text-sm text-gray-600 mt-1">基于机器学习的自适应威胁检测规则</p>
                            </div>
                            <button onclick="addCustomRule()" class="bg-gradient-to-r from-purple-500 to-blue-500 text-white px-4 py-2 rounded-lg hover:from-purple-600 hover:to-blue-600 transition-all">
                                <i class="fas fa-magic mr-2"></i>
                                AI生成规则
                            </button>
                        </div>
                        <!-- 规则学习状态 -->
                        <div class="mt-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg p-3">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <div class="text-sm">
                                        <span class="text-gray-600">活跃规则:</span>
                                        <span class="font-bold text-ai">12条</span>
                                    </div>
                                    <div class="text-sm">
                                        <span class="text-gray-600">AI优化:</span>
                                        <span class="font-bold text-success">+18%</span>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                                    <span class="text-xs text-green-600">实时学习中</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="space-y-4" id="custom-rules-list">
                            <!-- AI智能规则列表 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 处置知识库 -->
        <div id="disposal-tab" class="tab-content hidden">
            <div class="max-w-7xl mx-auto">
                <!-- 页面说明 -->
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg shadow-sm border border-blue-200 p-6 mb-6">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-tasks text-white text-lg"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">处置知识库</h3>
                                <p class="text-sm text-gray-600">识别和学习客户的个性化安全事件处置习惯</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4">
                            <div class="text-sm text-gray-500">
                                <i class="fas fa-check-circle mr-1"></i>
                                已识别习惯: <span class="font-bold text-ai">23</span>
                            </div>
                            <div class="text-sm text-gray-500">
                                <i class="fas fa-clock mr-1"></i>
                                今日新增: <span class="font-bold text-learning">5</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 处置习惯分类 -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- 高危事件处置习惯 -->
                    <div class="bg-white rounded-lg shadow-sm border card-hover">
                        <div class="p-6 border-b border-gray-200">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-exclamation-triangle text-red-600 text-lg"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold text-gray-900">高危事件处置习惯</h3>
                                        <p class="text-sm text-gray-600">AI分析客户对高危安全事件的处置模式</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></div>
                                    <span class="text-xs text-red-600 font-medium">实时分析</span>
                                </div>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="space-y-4">
                                <!-- 处置习惯项 -->
                                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center text-xs font-bold">1</div>
                                        <div class="flex-1">
                                            <h4 class="font-medium text-red-800 mb-1">SQL注入攻击 → 立即阻断</h4>
                                            <p class="text-sm text-red-700 mb-2">AI识别：用户习惯对SQL注入攻击进行立即阻断处置</p>
                                            <div class="flex items-center space-x-4 text-xs text-red-600">
                                                <span><i class="fas fa-chart-line mr-1"></i>识别频率: 89%</span>
                                                <span><i class="fas fa-clock mr-1"></i>平均响应时间: 3分钟</span>
                                                <span><i class="fas fa-shield-alt mr-1"></i>阻断成功率: 100%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center text-xs font-bold">2</div>
                                        <div class="flex-1">
                                            <h4 class="font-medium text-red-800 mb-1">恶意文件上传 → 隔离+取证</h4>
                                            <p class="text-sm text-red-700 mb-2">AI识别：用户习惯对恶意文件上传进行隔离并启动取证流程</p>
                                            <div class="flex items-center space-x-4 text-xs text-red-600">
                                                <span><i class="fas fa-chart-line mr-1"></i>识别频率: 76%</span>
                                                <span><i class="fas fa-clock mr-1"></i>平均响应时间: 8分钟</span>
                                                <span><i class="fas fa-search mr-1"></i>取证成功率: 95%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-red-600 text-white rounded-full flex items-center justify-center text-xs font-bold">3</div>
                                        <div class="flex-1">
                                            <h4 class="font-medium text-red-800 mb-1">内网横向移动 → 网络隔离</h4>
                                            <p class="text-sm text-red-700 mb-2">AI识别：用户习惯对内网横向移动进行网络隔离处置</p>
                                            <div class="flex items-center space-x-4 text-xs text-red-600">
                                                <span><i class="fas fa-chart-line mr-1"></i>识别频率: 82%</span>
                                                <span><i class="fas fa-clock mr-1"></i>平均响应时间: 5分钟</span>
                                                <span><i class="fas fa-network-wired mr-1"></i>隔离成功率: 98%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 中等威胁处置习惯 -->
                    <div class="bg-white rounded-lg shadow-sm border card-hover">
                        <div class="p-6 border-b border-gray-200">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-exclamation-circle text-yellow-600 text-lg"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold text-gray-900">中等威胁处置习惯</h3>
                                        <p class="text-sm text-gray-600">AI分析客户对中等威胁的处置偏好</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-yellow-500 rounded-full animate-pulse"></div>
                                    <span class="text-xs text-yellow-600 font-medium">持续学习</span>
                                </div>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="space-y-4">
                                <!-- 处置习惯项 -->
                                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-yellow-600 text-white rounded-full flex items-center justify-center text-xs font-bold">1</div>
                                        <div class="flex-1">
                                            <h4 class="font-medium text-yellow-800 mb-1">暴力破解攻击 → 加强监控</h4>
                                            <p class="text-sm text-yellow-700 mb-2">AI识别：用户习惯对暴力破解攻击进行加强监控，观察后续行为</p>
                                            <div class="flex items-center space-x-4 text-xs text-yellow-600">
                                                <span><i class="fas fa-chart-line mr-1"></i>识别频率: 67%</span>
                                                <span><i class="fas fa-clock mr-1"></i>平均监控时间: 2小时</span>
                                                <span><i class="fas fa-eye mr-1"></i>后续处置率: 34%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-yellow-600 text-white rounded-full flex items-center justify-center text-xs font-bold">2</div>
                                        <div class="flex-1">
                                            <h4 class="font-medium text-yellow-800 mb-1">异常端口扫描 → 记录+告警</h4>
                                            <p class="text-sm text-yellow-700 mb-2">AI识别：用户习惯对异常端口扫描进行记录并发送告警通知</p>
                                            <div class="flex items-center space-x-4 text-xs text-yellow-600">
                                                <span><i class="fas fa-chart-line mr-1"></i>识别频率: 73%</span>
                                                <span><i class="fas fa-clock mr-1"></i>平均响应时间: 15分钟</span>
                                                <span><i class="fas fa-bell mr-1"></i>告警发送率: 100%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-yellow-600 text-white rounded-full flex items-center justify-center text-xs font-bold">3</div>
                                        <div class="flex-1">
                                            <h4 class="font-medium text-yellow-800 mb-1">可疑外联行为 → 深度分析</h4>
                                            <p class="text-sm text-yellow-700 mb-2">AI识别：用户习惯对可疑外联行为进行深度分析，检查数据流量</p>
                                            <div class="flex items-center space-x-4 text-xs text-yellow-600">
                                                <span><i class="fas fa-chart-line mr-1"></i>识别频率: 58%</span>
                                                <span><i class="fas fa-clock mr-1"></i>平均分析时间: 45分钟</span>
                                                <span><i class="fas fa-search mr-1"></i>分析完成率: 89%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 低危告警处置习惯 -->
                    <div class="bg-white rounded-lg shadow-sm border card-hover">
                        <div class="p-6 border-b border-gray-200">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-info-circle text-green-600 text-lg"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold text-gray-900">低危告警处置习惯</h3>
                                        <p class="text-sm text-gray-600">AI分析客户对低危告警的处置策略</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                                    <span class="text-xs text-green-600 font-medium">智能优化</span>
                                </div>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="space-y-4">
                                <!-- 处置习惯项 -->
                                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center text-xs font-bold">1</div>
                                        <div class="flex-1">
                                            <h4 class="font-medium text-green-800 mb-1">内部工具访问 → 标记忽略</h4>
                                            <p class="text-sm text-green-700 mb-2">AI识别：用户习惯对内部工具的正常访问进行标记忽略</p>
                                            <div class="flex items-center space-x-4 text-xs text-green-600">
                                                <span><i class="fas fa-chart-line mr-1"></i>识别频率: 92%</span>
                                                <span><i class="fas fa-clock mr-1"></i>平均处理时间: 30秒</span>
                                                <span><i class="fas fa-check mr-1"></i>自动化程度: 85%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center text-xs font-bold">2</div>
                                        <div class="flex-1">
                                            <h4 class="font-medium text-green-800 mb-1">已知误报 → 批量处理</h4>
                                            <p class="text-sm text-green-700 mb-2">AI识别：用户习惯对已知误报进行批量处理，提高效率</p>
                                            <div class="flex items-center space-x-4 text-xs text-green-600">
                                                <span><i class="fas fa-chart-line mr-1"></i>识别频率: 78%</span>
                                                <span><i class="fas fa-clock mr-1"></i>平均处理时间: 2分钟</span>
                                                <span><i class="fas fa-layer-group mr-1"></i>批量处理率: 90%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center text-xs font-bold">3</div>
                                        <div class="flex-1">
                                            <h4 class="font-medium text-green-800 mb-1">健康检查告警 → 自动过滤</h4>
                                            <p class="text-sm text-green-700 mb-2">AI识别：用户习惯对健康检查相关告警进行自动过滤</p>
                                            <div class="flex items-center space-x-4 text-xs text-green-600">
                                                <span><i class="fas fa-chart-line mr-1"></i>识别频率: 95%</span>
                                                <span><i class="fas fa-clock mr-1"></i>平均处理时间: 5秒</span>
                                                <span><i class="fas fa-filter mr-1"></i>过滤准确率: 98%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 业务相关处置习惯 -->
                    <div class="bg-white rounded-lg shadow-sm border card-hover">
                        <div class="p-6 border-b border-gray-200">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-building text-blue-600 text-lg"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold text-gray-900">业务相关处置习惯</h3>
                                        <p class="text-sm text-gray-600">AI分析客户对业务相关安全事件的处置偏好</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse"></div>
                                    <span class="text-xs text-blue-600 font-medium">业务优化</span>
                                </div>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="space-y-4">
                                <!-- 处置习惯项 -->
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-bold">1</div>
                                        <div class="flex-1">
                                            <h4 class="font-medium text-blue-800 mb-1">业务时间攻击 → 优先处理</h4>
                                            <p class="text-sm text-blue-700 mb-2">AI识别：用户习惯对业务时间内发生的攻击进行优先处理</p>
                                            <div class="flex items-center space-x-4 text-xs text-blue-600">
                                                <span><i class="fas fa-chart-line mr-1"></i>识别频率: 88%</span>
                                                <span><i class="fas fa-clock mr-1"></i>平均响应时间: 1分钟</span>
                                                <span><i class="fas fa-star mr-1"></i>优先级提升: 高</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-bold">2</div>
                                        <div class="flex-1">
                                            <h4 class="font-medium text-blue-800 mb-1">核心资产告警 → 立即通知</h4>
                                            <p class="text-sm text-blue-700 mb-2">AI识别：用户习惯对核心业务资产的告警进行立即通知</p>
                                            <div class="flex items-center space-x-4 text-xs text-blue-600">
                                                <span><i class="fas fa-chart-line mr-1"></i>识别频率: 91%</span>
                                                <span><i class="fas fa-clock mr-1"></i>平均通知时间: 30秒</span>
                                                <span><i class="fas fa-phone mr-1"></i>通知覆盖率: 100%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-bold">3</div>
                                        <div class="flex-1">
                                            <h4 class="font-medium text-blue-800 mb-1">数据泄露风险 → 联系业务方</h4>
                                            <p class="text-sm text-blue-700 mb-2">AI识别：用户习惯对数据泄露风险事件联系相关业务方确认</p>
                                            <div class="flex items-center space-x-4 text-xs text-blue-600">
                                                <span><i class="fas fa-chart-line mr-1"></i>识别频率: 72%</span>
                                                <span><i class="fas fa-clock mr-1"></i>平均联系时间: 5分钟</span>
                                                <span><i class="fas fa-users mr-1"></i>业务方响应率: 87%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI智能建议 -->
                <div class="mt-6 bg-white rounded-lg shadow-sm border card-hover">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-brain text-white text-lg"></i>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-900">AI智能建议</h3>
                                    <p class="text-sm text-gray-600">基于处置习惯分析的智能优化建议</p>
                                </div>
                            </div>
                            <button onclick="refreshDisposalSuggestions()" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-4 py-2 rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all">
                                <i class="fas fa-sync-alt mr-2"></i>
                                刷新建议
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="disposal-suggestions">
                            <!-- AI建议内容 -->
                            <div class="bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-4">
                                <div class="flex items-start space-x-3">
                                    <div class="w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center text-xs">
                                        <i class="fas fa-lightbulb"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-medium text-purple-800 mb-1">自动化建议</h4>
                                        <p class="text-sm text-purple-700 mb-2">建议对"健康检查告警"设置自动化处理规则，可节省95%的处理时间</p>
                                        <div class="flex items-center space-x-2">
                                            <button onclick="applyDisposalSuggestion('auto-health-check')" class="text-xs bg-purple-600 text-white px-3 py-1 rounded-full hover:bg-purple-700">
                                                应用建议
                                            </button>
                                            <span class="text-xs text-purple-600">预计效果：+95%效率</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-start space-x-3">
                                    <div class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs">
                                        <i class="fas fa-chart-line"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-medium text-blue-800 mb-1">优化建议</h4>
                                        <p class="text-sm text-blue-700 mb-2">建议对"暴力破解攻击"调整监控策略，从观察型转为预防型处置</p>
                                        <div class="flex items-center space-x-2">
                                            <button onclick="applyDisposalSuggestion('optimize-brute-force')" class="text-xs bg-blue-600 text-white px-3 py-1 rounded-full hover:bg-blue-700">
                                                应用建议
                                            </button>
                                            <span class="text-xs text-blue-600">预计效果：+40%防护</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-gradient-to-r from-green-50 to-teal-50 border border-green-200 rounded-lg p-4">
                                <div class="flex items-start space-x-3">
                                    <div class="w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center text-xs">
                                        <i class="fas fa-users"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-medium text-green-800 mb-1">协作建议</h4>
                                        <p class="text-sm text-green-700 mb-2">建议建立与业务方的快速响应机制，缩短数据泄露风险的确认时间</p>
                                        <div class="flex items-center space-x-2">
                                            <button onclick="applyDisposalSuggestion('improve-collaboration')" class="text-xs bg-green-600 text-white px-3 py-1 rounded-full hover:bg-green-700">
                                                应用建议
                                            </button>
                                            <span class="text-xs text-green-600">预计效果：+60%响应速度</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-gradient-to-r from-orange-50 to-red-50 border border-orange-200 rounded-lg p-4">
                                <div class="flex items-start space-x-3">
                                    <div class="w-8 h-8 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs">
                                        <i class="fas fa-shield-alt"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-medium text-orange-800 mb-1">安全建议</h4>
                                        <p class="text-sm text-orange-700 mb-2">建议对高危事件处置时同步启动备份验证，避免数据丢失风险</p>
                                        <div class="flex items-center space-x-2">
                                            <button onclick="applyDisposalSuggestion('backup-verification')" class="text-xs bg-orange-600 text-white px-3 py-1 rounded-full hover:bg-orange-700">
                                                应用建议
                                            </button>
                                            <span class="text-xs text-orange-600">预计效果：+80%数据安全</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 在场学习 -->
        <div id="context-tab" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- 学习演示区域 -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-lg shadow-sm border card-hover">
                        <div class="p-6 border-b border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-900">
                                <i class="fas fa-mouse-pointer text-learning mr-2"></i>
                                在场学习演示
                            </h3>
                            <p class="text-sm text-gray-600 mt-1">在分析界面直接划选文本或点击IP地址，即可教AI学习</p>
                        </div>
                        <div class="p-6">
                            <!-- 模拟告警详情 -->
                            <div class="bg-gray-50 rounded-lg p-4 mb-4">
                                <h4 class="font-medium text-gray-800 mb-3">模拟告警详情：</h4>
                                <div class="space-y-3">
                                    <div class="flex items-center space-x-4">
                                        <span class="text-sm text-gray-600">攻击源IP:</span>
                                        <span class="knowledge-item font-mono text-blue-600 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded relative group">
                                            192.168.10.50
                                            <button onclick="teachAI('ip', '192.168.10.50')" class="teach-ai-btn absolute -top-2 -right-2 w-6 h-6 bg-ai text-white rounded-full text-xs hover:bg-purple-700">
                                                🧠
                                            </button>
                                        </span>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <span class="text-sm text-gray-600">目标IP:</span>
                                        <span class="knowledge-item font-mono text-blue-600 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded relative group">
                                            10.10.10.10
                                            <button onclick="teachAI('ip', '10.10.10.10')" class="teach-ai-btn absolute -top-2 -right-2 w-6 h-6 bg-ai text-white rounded-full text-xs hover:bg-purple-700">
                                                🧠
                                            </button>
                                        </span>
                                    </div>
                                    <div>
                                        <span class="text-sm text-gray-600 block mb-2">HTTP请求详情:</span>
                                        <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-4 font-mono text-sm selectable-text hover:border-ai hover:bg-blue-50 transition-colors cursor-text" id="demo-payload">
                                            <div class="text-xs text-gray-500 mb-2">
                                                <i class="fas fa-mouse-pointer mr-1"></i>
                                                试试划选下面的文本，特别是高亮的部分
                                            </div>
GET /admin/login HTTP/1.1
Host: 10.10.10.10
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 <span class="bg-yellow-200 px-1 rounded border border-yellow-400 font-semibold cursor-pointer hover:bg-yellow-300 transition-colors">HealthChecker/1.0</span>
Accept: text/html,application/xhtml+xml
Connection: keep-alive
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 学习指导 -->
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <h5 class="font-medium text-blue-800 mb-3">
                                    <i class="fas fa-lightbulb mr-2"></i>
                                    学习操作指南
                                </h5>
                                <div class="space-y-3">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold">1</div>
                                        <div class="text-sm text-blue-700">
                                            <strong>标记资产属性：</strong> 点击IP地址旁的 🧠 图标，可标记资产属性
                                        </div>
                                    </div>
                                    <div class="flex items-start space-x-3">
                                        <div class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold">2</div>
                                        <div class="text-sm text-blue-700">
                                            <strong>划选文本学习：</strong> 用鼠标划选HTTP请求中的 <span class="bg-yellow-200 px-1 rounded font-mono">"HealthChecker/1.0"</span> 文本，会弹出浮动工具条
                                        </div>
                                    </div>
                                    <div class="flex items-start space-x-3">
                                        <div class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold">3</div>
                                        <div class="text-sm text-blue-700">
                                            <strong>确认学习：</strong> 点击浮动工具条中的"标记为良性"按钮，AI会记住这个特征
                                        </div>
                                    </div>
                                    <div class="bg-white rounded p-2 mt-2">
                                        <div class="text-xs text-blue-600">
                                            <i class="fas fa-info-circle mr-1"></i>
                                            <strong>提示：</strong> 所有学习的知识都会立即生效，提升AI分析准确性
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 学习记录 -->
                <div>
                    <div class="bg-white rounded-lg shadow-sm border card-hover">
                        <div class="p-6 border-b border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-900">
                                <i class="fas fa-history text-gray-600 mr-2"></i>
                                最近学习记录
                            </h3>
                        </div>
                        <div class="p-6">
                            <div class="space-y-4" id="recent-learning-list">
                                <!-- 学习记录列表 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 学习统计 -->
        <div id="analytics-tab" class="tab-content hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                <!-- 统计卡片 -->
                <div class="bg-white rounded-lg shadow-sm border card-hover p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-ai/10 rounded-lg flex items-center justify-center">
                            <i class="fas fa-database text-ai text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <h4 class="text-2xl font-bold text-gray-900">156</h4>
                            <p class="text-sm text-gray-600">总知识项</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-sm border card-hover p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-learning/10 rounded-lg flex items-center justify-center">
                            <i class="fas fa-server text-learning text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <h4 class="text-2xl font-bold text-gray-900">89</h4>
                            <p class="text-sm text-gray-600">资产知识</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-sm border card-hover p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-success/10 rounded-lg flex items-center justify-center">
                            <i class="fas fa-check-shield text-success text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <h4 class="text-2xl font-bold text-gray-900">67</h4>
                            <p class="text-sm text-gray-600">可信特征</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-sm border card-hover p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-gradient-to-r from-red-100 to-green-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-sync-alt text-green-600 text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <h4 class="text-2xl font-bold text-green-600">23次</h4>
                            <p class="text-sm text-gray-600">AI纠正误判</p>
                            <p class="text-xs text-green-500 mt-1">准确率提升+15%</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI优化成果展示 -->
            <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg shadow-sm border border-blue-200 p-6 mb-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-brain text-white text-lg"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">AI优化成果</h3>
                            <p class="text-sm text-gray-600">最新的AI学习和优化表现</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                        <span class="text-xs text-green-600 font-medium">实时优化中</span>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white rounded-lg p-4 border border-blue-100">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-red-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-exclamation-triangle text-red-500 text-sm"></i>
                            </div>
                            <div>
                                <div class="text-sm font-medium text-gray-800">纠正人工误判</div>
                                <div class="text-xs text-gray-500">最近7天</div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="text-2xl font-bold text-red-500">8次</div>
                            <div class="text-xs text-gray-600">包含杜少的3次误判</div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border border-green-100">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-check-circle text-green-500 text-sm"></i>
                            </div>
                            <div>
                                <div class="text-sm font-medium text-gray-800">准确率提升</div>
                                <div class="text-xs text-gray-500">对比上周</div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="text-2xl font-bold text-green-500">+15%</div>
                            <div class="text-xs text-gray-600">从87%提升至92%</div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg p-4 border border-purple-100">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-lightbulb text-purple-500 text-sm"></i>
                            </div>
                            <div>
                                <div class="text-sm font-medium text-gray-800">智能建议</div>
                                <div class="text-xs text-gray-500">已被采纳</div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="text-2xl font-bold text-purple-500">16条</div>
                            <div class="text-xs text-gray-600">采纳率89%</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 学习趋势图 -->
            <div class="bg-white rounded-lg shadow-sm border card-hover">
                <div class="p-6 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900">
                        <i class="fas fa-chart-area text-ai mr-2"></i>
                        学习趋势分析
                    </h3>
                </div>
                <div class="p-6">
                    <div class="h-64 flex items-center justify-center border-2 border-dashed border-gray-300 rounded-lg">
                        <div class="text-center">
                            <i class="fas fa-chart-line text-gray-400 text-4xl mb-4"></i>
                            <p class="text-gray-500">学习趋势图表区域</p>
                            <p class="text-sm text-gray-400">可集成Chart.js等图表库显示数据</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 浮动工具条（用于文本选择后显示） -->
    <div id="floating-toolbar" class="fixed hidden floating-toolbar text-white px-4 py-2 rounded-lg" style="z-index: 9999;">
        <div class="flex items-center space-x-2">
            <div class="text-xs opacity-75 mr-2">选中: "<span id="selected-text-preview"></span>"</div>
            <button class="hover:bg-white/20 px-3 py-1 rounded text-sm font-medium transition-colors" onclick="markAsGood()">
                <i class="fas fa-check mr-1"></i>标记为良性
            </button>
            <button class="hover:bg-white/20 px-3 py-1 rounded text-sm font-medium transition-colors" onclick="markAsThreat()">
                <i class="fas fa-exclamation-triangle mr-1"></i>定义为威胁
            </button>
            <button class="hover:bg-white/20 px-3 py-1 rounded text-sm font-medium transition-colors" onclick="globalSearch()">
                <i class="fas fa-search mr-1"></i>全局搜索
            </button>
        </div>
    </div>

    <!-- 学习弹窗模态框 -->
    <div id="learning-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                    <h3 class="text-lg font-semibold text-gray-900">
                        <i class="fas fa-brain text-ai mr-2"></i>
                        教AI学习
                    </h3>
                    <button class="text-gray-400 hover:text-gray-600" onclick="closeLearningModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="p-6" id="learning-modal-content">
                <!-- 动态内容 -->
            </div>
        </div>
    </div>

    <script>
        // 标签页切换功能
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabId = this.dataset.tab;
                
                // 更新按钮状态
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // 显示对应内容
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.add('hidden');
                });
                document.getElementById(tabId + '-tab').classList.remove('hidden');
            });
        });

        // 初始化数据
        document.addEventListener('DOMContentLoaded', function() {
            initializeAssetKnowledge();
            initializeAISuggestions();
            initializeRecentLearning();
            initializeCustomRules();
            initializeDisposalKnowledge();
            setupTextSelection();
        });

        // 资产知识数据存储
        let assetKnowledgeData = [
            {
                id: 1,
                entity: '192.168.50.98',
                tags: ['漏扫服务器', '安全设备'],
                business: '安全运维部',
                source: 'AI智能识别',
                time: '2025-06-29 11:30'
            },
            {
                id: 2,
                entity: '10.20.100.5',
                tags: ['代理服务器', '网络设备'],
                business: '网络运维部',
                source: 'AI智能识别',
                time: '2025-06-29 11:25'
            },
            {
                id: 3,
                entity: '172.16.88.12',
                tags: ['代理服务器', '负载均衡'],
                business: '应用运维部',
                source: 'AI智能识别',
                time: '2025-06-29 11:20'
            },
            {
                id: 4,
                entity: '192.168.1.100',
                tags: ['Web服务器', '生产环境'],
                business: '电商平台',
                source: '由张工手动添加',
                time: '2025-06-29 14:30'
            },
            {
                id: 5,
                entity: '10.10.10.10', 
                tags: ['自动化运维平台'],
                business: '运维部',
                source: '从事件INC-123学习',
                time: '2025-06-29 16:45'
            },
            {
                id: 6,
                entity: '172.16.0.50',
                tags: ['数据库服务器', '核心系统'],
                business: '研发部-核心交易组',
                source: '由李经理手动添加',
                time: '2025-06-28 09:20'
            }
        ];

        // 初始化资产知识列表
        function initializeAssetKnowledge() {
            renderAssetKnowledgeList();
        }

        // 渲染资产知识列表
        function renderAssetKnowledgeList(filteredData = null) {
            const data = filteredData || assetKnowledgeData;
            const tbody = document.getElementById('asset-knowledge-list');
            
            tbody.innerHTML = data.map(item => `
                <tr class="hover:bg-gray-50" data-id="${item.id}">
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="font-mono text-sm text-blue-600">${item.entity}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex flex-wrap gap-1">
                            ${item.tags.map(tag => `<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-ai/10 text-ai">${tag}</span>`).join('')}
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.business}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${item.source}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="editAssetKnowledge(${item.id})" class="text-ai hover:text-purple-700 mr-3">编辑</button>
                        <button onclick="deleteAssetKnowledge(${item.id})" class="text-red-600 hover:text-red-800">删除</button>
                    </td>
                </tr>
            `).join('');
        }

        // 添加资产知识
        function addAssetKnowledge() {
            showAssetKnowledgeModal();
        }

        // 编辑资产知识
        function editAssetKnowledge(id) {
            const asset = assetKnowledgeData.find(item => item.id === id);
            if (asset) {
                showAssetKnowledgeModal(asset);
            }
        }

        // 删除资产知识
        function deleteAssetKnowledge(id) {
            if (confirm('确定要删除这条资产知识吗？')) {
                assetKnowledgeData = assetKnowledgeData.filter(item => item.id !== id);
                renderAssetKnowledgeList();
                showNotification('资产知识已删除', 'success');
                updateStatistics();
            }
        }

        // 显示资产知识编辑模态框
        function showAssetKnowledgeModal(asset = null) {
            const modal = document.getElementById('learning-modal');
            const content = document.getElementById('learning-modal-content');
            
            const isEdit = asset !== null;
            content.innerHTML = `
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">资产实体</label>
                        <input type="text" id="asset-entity" value="${asset ? asset.entity : ''}" 
                               placeholder="192.168.1.100 或 server-name" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">资产标签</label>
                        <input type="text" id="asset-tags" value="${asset ? asset.tags.join(', ') : ''}" 
                               placeholder="Web服务器, 生产环境" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                        <p class="text-xs text-gray-500 mt-1">多个标签用逗号分隔</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">业务归属</label>
                        <input type="text" id="asset-business" value="${asset ? asset.business : ''}" 
                               placeholder="电商平台" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                    </div>
                    <div class="flex space-x-3">
                        <button onclick="saveAssetKnowledge(${asset ? asset.id : 'null'})" 
                                class="flex-1 bg-ai text-white py-2 rounded-lg hover:bg-purple-700">
                            ${isEdit ? '保存修改' : '添加资产知识'}
                        </button>
                        <button onclick="closeLearningModal()" 
                                class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                            取消
                        </button>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // 保存资产知识
        function saveAssetKnowledge(id) {
            const entity = document.getElementById('asset-entity').value.trim();
            const tags = document.getElementById('asset-tags').value.split(',').map(tag => tag.trim()).filter(tag => tag);
            const business = document.getElementById('asset-business').value.trim();
            
            if (!entity) {
                showNotification('请填写资产实体', 'error');
                return;
            }
            
            const assetData = {
                entity,
                tags,
                business,
                source: id ? '用户修改' : '用户手动添加',
                time: new Date().toLocaleString('zh-CN')
            };
            
            if (id) {
                // 编辑现有资产
                const index = assetKnowledgeData.findIndex(item => item.id === id);
                if (index !== -1) {
                    assetKnowledgeData[index] = { ...assetKnowledgeData[index], ...assetData };
                }
                showNotification('资产知识已更新', 'success');
            } else {
                // 添加新资产
                const newAsset = {
                    id: Date.now(),
                    ...assetData
                };
                assetKnowledgeData.push(newAsset);
                showNotification('资产知识已添加', 'success');
            }
            
            renderAssetKnowledgeList();
            closeLearningModal();
            updateStatistics();
        }

        // 搜索资产知识
        function searchAssetKnowledge() {
            const searchTerm = document.getElementById('asset-search').value.toLowerCase();
            const filterType = document.getElementById('asset-filter').value;
            
            let filteredData = assetKnowledgeData;
            
            // 按搜索词筛选
            if (searchTerm) {
                filteredData = filteredData.filter(item => 
                    item.entity.toLowerCase().includes(searchTerm) ||
                    item.tags.some(tag => tag.toLowerCase().includes(searchTerm)) ||
                    item.business.toLowerCase().includes(searchTerm)
                );
            }
            
            // 按类型筛选
            if (filterType) {
                filteredData = filteredData.filter(item => 
                    item.tags.some(tag => tag.includes(filterType))
                );
            }
            
            renderAssetKnowledgeList(filteredData);
        }

        // 筛选资产知识
        function filterAssetKnowledge() {
            searchAssetKnowledge(); // 复用搜索逻辑
        }

        // 初始化最近学习记录
        function initializeRecentLearning() {
            const container = document.getElementById('recent-learning-list');
            container.innerHTML = learningRecords.map(record => `
                <div class="flex items-start space-x-3 p-3 border ${record.highlight ? 'border-orange-200 bg-orange-50' : 'border-gray-200'} rounded-lg hover:bg-gray-50 ${record.highlight ? 'shadow-md' : ''}">
                    <div class="w-8 h-8 flex items-center justify-center rounded-full ${record.highlight ? 'bg-orange-100' : 'bg-gray-100'}">
                        <i class="fas ${record.icon} ${record.color}"></i>
                    </div>
                    <div class="flex-1">
                        <div class="text-sm font-medium text-gray-800 flex items-center">
                            ${record.type}
                            ${record.highlight ? '<span class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-700"><i class="fas fa-star mr-1"></i>重要</span>' : ''}
                        </div>
                        <div class="text-sm text-gray-600">${record.content}</div>
                        <div class="text-xs text-gray-500 mt-1">${record.time}</div>
                    </div>
                </div>
            `).join('');
        }

        // AI智能规则引擎数据存储
        let intelligentRules = [];

        // 初始化AI智能规则引擎
        function initializeCustomRules() {
            const rules = [
                {
                    name: '业务健康检查优化',
                    condition: 'User-Agent匹配健康检查模式',
                    action: 'AI上下文分析',
                    status: '已优化',
                    confidence: '97%',
                    aiGenerated: false,
                    tuningCount: 12,
                    adaptations: 12,
                    lastOptimized: '30分钟前',
                    feature: 'HealthChecker/1.0',
                    learnType: '良性模式识别',
                    ignoreScope: '全局忽略',
                    assetScope: '全部',
                    remark: '内部业务健康检查探针，用于监控服务状态'
                },
                {
                    name: '供应链流量模式',
                    condition: 'API调用频率异常检测',
                    action: 'AI行为基线对比',
                    status: '自适应',
                    confidence: '89%',
                    aiGenerated: true,
                    tuningCount: 8,
                    adaptations: 8,
                    lastOptimized: '1小时前',
                    feature: 'API频率模式',
                    learnType: 'GPT研判优化',
                    ignoreScope: '仅在Web攻击告警中忽略',
                    assetScope: '生产环境资产',
                    remark: '供应链API调用频率基线分析'
                },
                {
                    name: '内网扫描智能识别',
                    condition: '来源IP在192.168.1.0/24且目标端口为22',
                    action: '动态风险评估',
                    status: '学习中',
                    confidence: '94%',
                    aiGenerated: true,
                    tuningCount: 5,
                    adaptations: 5,
                    lastOptimized: '2小时前',
                    feature: '内网SSH扫描',
                    learnType: '运维行为模式',
                    ignoreScope: '仅在SQL注入告警中忽略',
                    assetScope: '办公网资产',
                    remark: '内网运维工具SSH扫描行为识别'
                },
                {
                    name: 'SQL注入语义检测',
                    condition: 'Payload包含SQL关键字组合',
                    action: 'GPT语义理解分析',
                    status: '已优化',
                    confidence: '95%',
                    aiGenerated: false,
                    tuningCount: 23,
                    adaptations: 23,
                    lastOptimized: '15分钟前',
                    feature: 'SQL语义特征',
                    learnType: 'GPT研判优化',
                    ignoreScope: '全局忽略',
                    assetScope: 'Web服务器',
                    remark: 'SQL注入攻击的深度语义理解分析'
                },
                {
                    name: '异常登录行为分析',
                    condition: '登录时间、地点、设备异常组合',
                    action: 'AI风险评分模型',
                    status: '自适应',
                    confidence: '91%',
                    aiGenerated: true,
                    tuningCount: 15,
                    adaptations: 15,
                    lastOptimized: '45分钟前',
                    feature: '登录行为模式',
                    learnType: '业务特征模式',
                    ignoreScope: '仅在Web攻击告警中忽略',
                    assetScope: '核心业务资产',
                    remark: '基于时空和设备特征的异常登录检测'
                },
                {
                    name: '文件上传威胁检测',
                    condition: '文件类型、大小、内容特征分析',
                    action: 'AI多维度威胁识别',
                    status: '学习中',
                    confidence: '87%',
                    aiGenerated: true,
                    tuningCount: 3,
                    adaptations: 3,
                    lastOptimized: '3小时前',
                    feature: '文件上传特征',
                    learnType: '良性模式识别',
                    ignoreScope: '仅在SQL注入告警中忽略',
                    assetScope: '应用服务器',
                    remark: '多维度文件上传威胁检测和识别'
                },
                {
                    name: 'XSS攻击模式识别',
                    condition: 'HTML/JS代码注入特征匹配',
                    action: 'AI语法树分析',
                    status: '已优化',
                    confidence: '93%',
                    aiGenerated: false,
                    tuningCount: 18,
                    adaptations: 18,
                    lastOptimized: '1小时前',
                    feature: 'XSS攻击载荷',
                    learnType: 'GPT研判优化',
                    ignoreScope: '仅在Web攻击告警中忽略',
                    assetScope: 'Web服务器',
                    remark: 'XSS攻击载荷的语法树深度分析'
                },
                {
                    name: '暴力破解检测优化',
                    condition: '短时间内多次失败登录尝试',
                    action: 'AI时间序列分析',
                    status: '自适应',
                    confidence: '96%',
                    aiGenerated: true,
                    tuningCount: 27,
                    adaptations: 27,
                    lastOptimized: '10分钟前',
                    feature: '登录失败模式',
                    learnType: '运维行为模式',
                    ignoreScope: '全局忽略',
                    assetScope: '全部',
                    remark: '基于时间序列的暴力破解检测优化'
                }
            ];

            // 保存到全局变量
            intelligentRules = rules;

            const container = document.getElementById('custom-rules-list');
            container.innerHTML = rules.map(rule => `
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-all duration-200 bg-gradient-to-r from-white to-blue-50">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <h4 class="font-medium text-gray-800">${rule.name}</h4>
                            ${rule.aiGenerated ? '<span class="inline-flex items-center px-2 py-1 rounded text-xs bg-ai text-white"><i class="fas fa-robot mr-1"></i>AI生成</span>' : ''}
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${rule.status === '学习中' ? 'bg-yellow-100 text-yellow-700' : rule.status === '已优化' ? 'bg-green-100 text-green-700' : 'bg-blue-100 text-blue-700'}">
                                ${rule.status}
                            </span>
                            <span class="text-xs text-gray-500">置信度: ${rule.confidence}</span>
                        </div>
                    </div>
                    <div class="space-y-2 mb-3">
                        <div class="text-sm">
                            <span class="text-gray-500">条件:</span>
                            <span class="text-gray-700">${rule.condition}</span>
                        </div>
                        <div class="text-sm">
                            <span class="text-gray-500">动作:</span>
                            <span class="text-gray-700">${rule.action}</span>
                        </div>
                    </div>
                    <div class="grid grid-cols-3 gap-3 text-sm bg-white/50 rounded p-2">
                        <div class="text-center">
                            <div class="text-ai font-bold">${rule.tuningCount}次</div>
                            <div class="text-xs text-gray-500">调优次数</div>
                        </div>
                        <div class="text-center">
                            <div class="text-blue-600 font-bold">${rule.adaptations}</div>
                            <div class="text-xs text-gray-500">自适应次数</div>
                        </div>
                        <div class="text-center">
                            <div class="text-gray-600 font-bold">${rule.lastOptimized}</div>
                            <div class="text-xs text-gray-500">最近优化</div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between mt-3 pt-3 border-t border-gray-100">
                        <div class="flex items-center space-x-3">
                            <button onclick="showRuleDetail('${rule.name}')" class="text-blue-600 hover:text-blue-800 text-sm px-3 py-1 rounded bg-blue-50 hover:bg-blue-100 transition-colors border border-blue-200">
                                <i class="fas fa-info-circle mr-1"></i>
                                详情
                            </button>
                            <button onclick="editRule('${rule.name}')" class="text-ai hover:text-purple-700 text-sm px-3 py-1 rounded bg-purple-50 hover:bg-purple-100 transition-colors border border-purple-200">
                                <i class="fas fa-edit mr-1"></i>
                                修改
                            </button>
                        </div>
                        <div class="text-xs text-gray-500">
                            最近优化: ${rule.lastOptimized}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // 设置文本选择功能
        function setupTextSelection() {
            document.addEventListener('mouseup', function(e) {
                // 等待一个短暂延迟以确保选择已完成
                setTimeout(() => {
                    const selection = window.getSelection();
                    const selectedText = selection.toString().trim();
                    
                    if (selectedText.length > 0) {
                        const range = selection.getRangeAt(0);
                        const rect = range.getBoundingClientRect();
                        
                        const toolbar = document.getElementById('floating-toolbar');
                        
                        // 改进定位计算，考虑页面滚动
                        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                        const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;
                        
                        toolbar.style.left = (rect.left + scrollLeft) + 'px';
                        toolbar.style.top = (rect.top + scrollTop - 60) + 'px';
                        toolbar.classList.remove('hidden');
                        
                        // 存储选中的文本
                        toolbar.dataset.selectedText = selectedText;
                        
                        // 更新预览文本
                        const preview = document.getElementById('selected-text-preview');
                        if (preview) {
                            preview.textContent = selectedText.length > 20 ? selectedText.substring(0, 20) + '...' : selectedText;
                        }
                        
                        console.log('文本已选择:', selectedText); // 调试信息
                        
                        // 显示成功提示
                        if (selectedText.includes('HealthChecker')) {
                            showNotification('文本选择成功！请点击"标记为良性"按钮', 'success');
                        }
                    } else {
                        // 如果没有选中文本，隐藏工具条
                        document.getElementById('floating-toolbar').classList.add('hidden');
                    }
                }, 10);
            });

            // 点击其他地方时隐藏工具条
            document.addEventListener('click', function(e) {
                if (!e.target.closest('#floating-toolbar')) {
                    const selection = window.getSelection();
                    if (selection.toString().trim().length === 0) {
                        document.getElementById('floating-toolbar').classList.add('hidden');
                    }
                }
            });

            // 键盘操作支持
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    document.getElementById('floating-toolbar').classList.add('hidden');
                    window.getSelection().removeAllRanges();
                }
            });
        }

        // 标记为良性
        function markAsGood() {
            const toolbar = document.getElementById('floating-toolbar');
            const selectedText = toolbar.dataset.selectedText;
            
            showLearningModal('good', selectedText);
            toolbar.classList.add('hidden');
        }

        // 标记为威胁
        function markAsThreat() {
            const toolbar = document.getElementById('floating-toolbar');
            const selectedText = toolbar.dataset.selectedText;
            
            showLearningModal('threat', selectedText);
            toolbar.classList.add('hidden');
        }

        // 全局搜索
        function globalSearch() {
            const toolbar = document.getElementById('floating-toolbar');
            const selectedText = toolbar.dataset.selectedText;
            
            showNotification(`搜索 "${selectedText}" 的相关信息...`, 'info');
            toolbar.classList.add('hidden');
        }

        // 显示学习模态框
        function showLearningModal(type, text) {
            const modal = document.getElementById('learning-modal');
            const content = document.getElementById('learning-modal-content');
            
            if (type === 'good') {
                content.innerHTML = `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">特征内容</label>
                            <input type="text" value="${text}" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">AI学习类型</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <option>良性模式识别</option>
                                <option>运维行为模式</option>
                                <option>内部域名模式</option>
                                <option>GPT研判优化</option>
                                <option>业务特征模式</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">忽略范围</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <option>全局忽略</option>
                                <option>仅在Web攻击告警中忽略</option>
                                <option>仅在SQL注入告警中忽略</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">生效资产</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <option selected>全部</option>
                                <option>生产环境资产</option>
                                <option>测试环境资产</option>
                                <option>办公网资产</option>
                                <option>DMZ区域资产</option>
                                <option>核心业务资产</option>
                                <option>Web服务器</option>
                                <option>数据库服务器</option>
                                <option>应用服务器</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">备注</label>
                            <textarea placeholder="内部业务健康检查探针" class="w-full px-3 py-2 border border-gray-300 rounded-lg h-20 resize-none"></textarea>
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="confirmLearning('good')" class="flex-1 bg-success text-white py-2 rounded-lg hover:bg-green-700">
                                确认，不再告警
                            </button>
                            <button onclick="closeLearningModal()" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                                取消
                            </button>
                        </div>
                    </div>
                `;
            }
            
            modal.classList.remove('hidden');
        }

        // 关闭学习模态框
        function closeLearningModal() {
            document.getElementById('learning-modal').classList.add('hidden');
        }

        // 确认学习
        function confirmLearning(type) {
            showNotification('学习成功！AI已记住这个特征', 'success');
            closeLearningModal();
            
            // 刷新相关数据
            setTimeout(() => {
                initializeRecentLearning();
            }, 500);
        }

        // 教AI功能 - 点击IP地址时调用
        function teachAI(type, value) {
            if (type === 'ip') {
                showIPLearningModal(value);
            }
        }

        // 显示IP学习模态框
        function showIPLearningModal(ip) {
            const modal = document.getElementById('learning-modal');
            const content = document.getElementById('learning-modal-content');
            
            content.innerHTML = `
                <div class="space-y-4">
                    <div class="text-center mb-4">
                        <div class="w-16 h-16 bg-ai/10 rounded-full flex items-center justify-center mx-auto mb-3">
                            <i class="fas fa-brain text-ai text-2xl"></i>
                        </div>
                        <h4 class="text-lg font-semibold text-gray-800">教AI学习资产信息</h4>
                        <p class="text-sm text-gray-600">为 <code class="bg-gray-100 px-2 py-1 rounded">${ip}</code> 添加资产属性</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">资产标签</label>
                        <input type="text" id="ip-tags" placeholder="例如: 自动化运维平台, 内部工具" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                        <p class="text-xs text-gray-500 mt-1">多个标签用逗号分隔</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">业务归属</label>
                        <input type="text" id="ip-business" placeholder="例如: 运维部" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">补充说明</label>
                        <textarea id="ip-description" placeholder="例如: Ansible自动化平台，会有大量SSH登录，属正常行为" 
                                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai h-20 resize-none"></textarea>
                    </div>
                    <div class="flex space-x-3">
                        <button onclick="saveIPLearning('${ip}')" 
                                class="flex-1 bg-ai text-white py-2 rounded-lg hover:bg-purple-700">
                            <i class="fas fa-brain mr-2"></i>好的，AI记住了
                        </button>
                        <button onclick="closeLearningModal()" 
                                class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                            取消
                        </button>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // 保存IP学习
        function saveIPLearning(ip) {
            const tags = document.getElementById('ip-tags').value.split(',').map(tag => tag.trim()).filter(tag => tag);
            const business = document.getElementById('ip-business').value.trim();
            const description = document.getElementById('ip-description').value.trim();
            
            if (tags.length === 0) {
                showNotification('请至少添加一个资产标签', 'error');
                return;
            }
            
            // 添加到资产知识库
            const newAsset = {
                id: Date.now(),
                entity: ip,
                tags: tags,
                business: business || '未知',
                source: '在场学习获得',
                time: new Date().toLocaleString('zh-CN'),
                description: description
            };
            
            assetKnowledgeData.push(newAsset);
            
            // 添加到学习记录
            addLearningRecord('资产标记', `${ip} → ${tags.join(', ')}`);
            
            showNotification('学习成功！AI已记住这个资产', 'success');
            closeLearningModal();
            renderAssetKnowledgeList();
            updateStatistics();
        }

        // 学习记录数据存储
        let learningRecords = [
            {
                id: 1,
                type: 'AI纠错',
                content: '纠正杜少对192.168.50.98的误判 → 改为"漏扫服务器"',
                time: '2分钟前',
                icon: 'fa-exclamation-triangle',
                color: 'text-orange-500',
                highlight: true
            },
            {
                id: 2,
                type: 'AI优化',
                content: 'GPT模型调优 → SQL注入检测准确率提升12%',
                time: '8分钟前',
                icon: 'fa-brain',
                color: 'text-purple-500'
            },
            {
                id: 3,
                type: 'AI纠错',
                content: '纠正杜少对"Python-requests"的威胁判断',
                time: '1小时前',
                icon: 'fa-sync-alt',
                color: 'text-red-500',
                highlight: true
            },
            {
                id: 4,
                type: '智能发现',
                content: 'AI识别出代理服务器10.20.100.5的行为特征',
                time: '2小时前',
                icon: 'fa-search',
                color: 'text-blue-500'
            },
            {
                id: 5,
                type: 'AI纠错',
                content: '纠正杜少对内网扫描的误报判断 → 降低15%误报',
                time: '3小时前',
                icon: 'fa-check-circle',
                color: 'text-green-500',
                highlight: true
            },
            {
                id: 6,
                type: '特征学习',
                content: 'HealthChecker/1.0 → 标记为良性特征',
                time: '昨天',
                icon: 'fa-check-shield',
                color: 'text-success'
            }
        ];

        // 添加学习记录
        function addLearningRecord(type, content) {
            const icons = {
                '资产标记': 'fa-server',
                '特征标记': 'fa-check-shield',
                'GPT调优': 'fa-brain',
                '规则定义': 'fa-code-branch'
            };
            
            const colors = {
                '资产标记': 'text-ai',
                '特征标记': 'text-success',
                'GPT调优': 'text-ai',
                '规则定义': 'text-warning'
            };
            
            const newRecord = {
                id: Date.now(),
                type,
                content,
                time: '刚刚',
                icon: icons[type] || 'fa-lightbulb',
                color: colors[type] || 'text-gray-600'
            };
            
            learningRecords.unshift(newRecord); // 添加到开头
            if (learningRecords.length > 10) {
                learningRecords = learningRecords.slice(0, 10); // 只保留最近10条
            }
            
            // 重新渲染学习记录
            const container = document.getElementById('recent-learning-list');
            container.innerHTML = learningRecords.map(record => `
                <div class="flex items-start space-x-3 p-3 border ${record.highlight ? 'border-orange-200 bg-orange-50' : 'border-gray-200'} rounded-lg hover:bg-gray-50 ${record.highlight ? 'shadow-md' : ''}">
                    <div class="w-8 h-8 flex items-center justify-center rounded-full ${record.highlight ? 'bg-orange-100' : 'bg-gray-100'}">
                        <i class="fas ${record.icon} ${record.color}"></i>
                    </div>
                    <div class="flex-1">
                        <div class="text-sm font-medium text-gray-800 flex items-center">
                            ${record.type}
                            ${record.highlight ? '<span class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-700"><i class="fas fa-star mr-1"></i>重要</span>' : ''}
                        </div>
                        <div class="text-sm text-gray-600">${record.content}</div>
                        <div class="text-xs text-gray-500 mt-1">${record.time}</div>
                    </div>
                </div>
            `).join('');
        }

        // 更新统计数据
        function updateStatistics() {
            // 更新总知识项（只计算资产知识）
            const totalKnowledge = assetKnowledgeData.length;
            
            // 更新页面头部统计
            const statElements = document.querySelectorAll('.text-2xl.font-bold');
            if (statElements.length >= 4) {
                statElements[0].textContent = totalKnowledge;
                statElements[1].textContent = assetKnowledgeData.length;
                // 其他统计项保持不变
            }
        }

        // 初始化AI智能建议
        function initializeAISuggestions() {
            const suggestions = [
                {
                    type: 'network-discovery',
                    title: 'AI发现新的网段模式',
                    description: '基于流量分析，发现172.20.0.0/16可能是数据库专用网段',
                    confidence: '89%',
                    action: '添加为已知网段',
                    icon: 'fa-network-wired',
                    color: 'text-blue-500',
                    priority: 'high',
                    detailInfo: {
                        networkRange: '172.20.0.0/16',
                        analysis: '该网段流量模式显示典型的数据库访问特征',
                        suggestedTags: ['数据库网段', '高敏感度'],
                        riskLevel: '高'
                    }
                },
                {
                    type: 'asset-discovery',
                    title: '发现新的代理服务器',
                    description: '192.168.100.88 表现出代理服务器行为特征，需要用户确认',
                    confidence: '92%',
                    action: '确认并标记',
                    icon: 'fa-server',
                    color: 'text-green-500',
                    priority: 'high',
                    detailInfo: {
                        assetIP: '192.168.100.88',
                        behaviorPattern: '大量转发请求，端口8080开放',
                        suggestedTags: ['代理服务器', '网络设备'],
                        department: '网络运维部'
                    }
                },
                {
                    type: 'asset-discovery',
                    title: '识别疑似漏扫设备',
                    description: '10.50.30.15 具有漏洞扫描器行为特征，建议确认归属',
                    confidence: '87%',
                    action: '确认设备类型',
                    icon: 'fa-search',
                    color: 'text-purple-500',
                    priority: 'medium',
                    detailInfo: {
                        assetIP: '10.50.30.15',
                        behaviorPattern: '对多个端口进行扫描，User-Agent包含安全工具特征',
                        suggestedTags: ['漏扫服务器', '安全设备'],
                        scanPorts: '22, 80, 443, 3389, 8080'
                    }
                }
            ];

            const container = document.getElementById('ai-suggestions');
            container.innerHTML = suggestions.map(suggestion => {
                const bgClass = suggestion.priority === 'high' ? 'bg-gradient-to-r from-white to-purple-50' : 
                               suggestion.priority === 'medium' ? 'bg-gradient-to-r from-white to-blue-50' : 
                               'bg-gradient-to-r from-white to-gray-50';
                
                const iconBgClass = suggestion.priority === 'high' ? 'bg-purple-100' : 
                                   suggestion.priority === 'medium' ? 'bg-blue-100' : 
                                   'bg-gray-100';
                
                const priorityBadgeClass = suggestion.priority === 'high' ? 'bg-red-100 text-red-700' : 
                                          suggestion.priority === 'medium' ? 'bg-yellow-100 text-yellow-700' : 
                                          'bg-gray-100 text-gray-700';
                
                const priorityText = suggestion.priority === 'high' ? '高优先级' : 
                                    suggestion.priority === 'medium' ? '中优先级' : 
                                    '低优先级';
                
                return `
                    <div class="border border-gray-200 rounded-lg p-4 hover:shadow-lg transition-all duration-300 ${bgClass} hover:scale-105">
                        <div class="flex items-start space-x-4">
                            <div class="w-12 h-12 rounded-lg flex items-center justify-center ${iconBgClass}">
                                <i class="fas ${suggestion.icon} ${suggestion.color} text-lg"></i>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between mb-2">
                                    <h4 class="font-semibold text-gray-900">${suggestion.title}</h4>
                                    <div class="flex items-center space-x-2">
                                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${priorityBadgeClass}">
                                            ${priorityText}
                                        </span>
                                        <span class="text-xs bg-ai text-white px-2 py-1 rounded-full">置信度: ${suggestion.confidence}</span>
                                    </div>
                                </div>
                                <p class="text-sm text-gray-700 mb-4 leading-relaxed">${suggestion.description}</p>
                                <div class="flex items-center justify-between">
                                    <button onclick="applySuggestion('${suggestion.type}', '${suggestion.title}')" class="flex items-center space-x-2 bg-gradient-to-r from-purple-500 to-blue-500 text-white px-4 py-2 rounded-lg text-sm hover:from-purple-600 hover:to-blue-600 transition-all transform hover:scale-105">
                                        <i class="fas fa-robot"></i>
                                        <span>${suggestion.action}</span>
                                    </button>
                                    <div class="flex items-center space-x-2">
                                        <button onclick="showSuggestionDetail(${JSON.stringify(suggestion).replace(/"/g, '&quot;')})" class="text-blue-600 hover:text-blue-800 text-sm px-3 py-1 rounded bg-blue-50 hover:bg-blue-100 transition-colors border border-blue-200">
                                            <i class="fas fa-info-circle mr-1"></i>
                                            详情
                                        </button>
                                        <button onclick="ignoreSuggestion('${suggestion.type}')" class="text-gray-500 hover:text-red-600 text-sm px-2 py-1 rounded hover:bg-red-50 transition-colors">
                                            <i class="fas fa-times mr-1"></i>
                                            忽略
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // 添加自定义规则
        function addCustomRule() {
            showNotification('自定义规则功能开发中，敬请期待！', 'info');
        }

        // 显示建议详情
        function showSuggestionDetail(suggestion) {
            const modal = document.getElementById('learning-modal');
            const content = document.getElementById('learning-modal-content');
            
            let detailHTML = '';
            
            if (suggestion.type === 'network-discovery') {
                detailHTML = `
                    <div class="space-y-4">
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-network-wired text-blue-600"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">${suggestion.title}</h3>
                                <p class="text-sm text-gray-600">置信度: ${suggestion.confidence}</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-medium text-gray-800 mb-3">网段分析详情</h4>
                            <div class="grid grid-cols-2 gap-3 text-sm">
                                <div>
                                    <span class="text-gray-600">网段范围：</span>
                                    <span class="font-mono text-blue-600">${suggestion.detailInfo.networkRange}</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">风险等级：</span>
                                    <span class="text-red-600 font-medium">${suggestion.detailInfo.riskLevel}</span>
                                </div>
                                <div class="col-span-2">
                                    <span class="text-gray-600">分析结果：</span>
                                    <p class="text-gray-800 mt-1">${suggestion.detailInfo.analysis}</p>
                                </div>
                                <div class="col-span-2">
                                    <span class="text-gray-600">建议标签：</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${suggestion.detailInfo.suggestedTags.map(tag => 
                                            `<span class="inline-flex items-center px-2 py-1 rounded text-xs bg-blue-100 text-blue-700">${tag}</span>`
                                        ).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (suggestion.type === 'asset-discovery') {
                detailHTML = `
                    <div class="space-y-4">
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                                <i class="fas ${suggestion.icon} ${suggestion.color}"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">${suggestion.title}</h3>
                                <p class="text-sm text-gray-600">置信度: ${suggestion.confidence}</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-medium text-gray-800 mb-3">资产分析详情</h4>
                            <div class="grid grid-cols-1 gap-3 text-sm">
                                <div>
                                    <span class="text-gray-600">资产IP：</span>
                                    <span class="font-mono text-blue-600">${suggestion.detailInfo.assetIP}</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">行为模式：</span>
                                    <p class="text-gray-800 mt-1">${suggestion.detailInfo.behaviorPattern}</p>
                                </div>
                                ${suggestion.detailInfo.scanPorts ? `
                                <div>
                                    <span class="text-gray-600">扫描端口：</span>
                                    <span class="font-mono text-gray-800">${suggestion.detailInfo.scanPorts}</span>
                                </div>
                                ` : ''}
                                <div>
                                    <span class="text-gray-600">建议归属：</span>
                                    <span class="text-gray-800">${suggestion.detailInfo.department || '待确认'}</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">建议标签：</span>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${suggestion.detailInfo.suggestedTags.map(tag => 
                                            `<span class="inline-flex items-center px-2 py-1 rounded text-xs bg-purple-100 text-purple-700">${tag}</span>`
                                        ).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            content.innerHTML = detailHTML + `
                <div class="flex space-x-3 mt-6">
                    <button onclick="applySuggestion('${suggestion.type}', '${suggestion.title}')" 
                            class="flex-1 bg-gradient-to-r from-purple-500 to-blue-500 text-white py-2 rounded-lg hover:from-purple-600 hover:to-blue-600">
                        ${suggestion.action}
                    </button>
                    <button onclick="closeLearningModal()" 
                            class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                        关闭
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // 应用建议
        function applySuggestion(type, title) {
            if (type === 'network-discovery') {
                showNotification('已将网段信息添加到资产知识库', 'success');
                // 这里可以添加实际的网段添加逻辑
            } else if (type === 'asset-discovery') {
                showNotification('已确认资产类型并添加到知识库', 'success');
                // 这里可以添加实际的资产添加逻辑
            }
            closeLearningModal();
        }

        // 忽略建议
        function ignoreSuggestion(type) {
            showNotification('已忽略该建议', 'info');
            // 这里可以添加从建议列表中移除的逻辑
        }

        // 显示通知
        function showNotification(message, type = 'info') {
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                warning: 'bg-yellow-500',
                info: 'bg-blue-500'
            };
            
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // CSS 样式
        const style = document.createElement('style');
        style.textContent = `
            .tab-btn {
                padding: 0.75rem 1.5rem;
                border-radius: 0.5rem;
                color: #6b7280;
                background: transparent;
                border: none;
                cursor: pointer;
                transition: all 0.2s ease;
                font-weight: 500;
            }
            .tab-btn:hover {
                color: #8b5cf6;
                background: #f3f4f6;
            }
            .tab-btn.active {
                color: #8b5cf6;
                background: #f3f0ff;
                border: 1px solid #e0e7ff;
            }
        `;
        document.head.appendChild(style);

        // 显示规则详情
        function showRuleDetail(ruleName) {
            const rule = intelligentRules.find(r => r.name === ruleName);
            if (!rule) return;

            const modal = document.getElementById('learning-modal');
            const content = document.getElementById('learning-modal-content');
            
            content.innerHTML = `
                <div class="space-y-4">
                    <div class="text-center mb-4">
                        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3">
                            <i class="fas fa-info-circle text-blue-600 text-2xl"></i>
                        </div>
                        <h4 class="text-lg font-semibold text-gray-800">${rule.name}</h4>
                        <p class="text-sm text-gray-600">规则详情信息</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">特征内容</label>
                        <input type="text" value="${rule.feature}" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50" readonly>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">AI学习类型</label>
                        <input type="text" value="${rule.learnType}" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50" readonly>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">忽略范围</label>
                        <input type="text" value="${rule.ignoreScope}" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50" readonly>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">生效资产</label>
                        <input type="text" value="${rule.assetScope}" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50" readonly>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">备注</label>
                        <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg h-20 resize-none bg-gray-50" readonly>${rule.remark}</textarea>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h5 class="font-medium text-gray-800 mb-3">规则统计信息</h5>
                        <div class="grid grid-cols-3 gap-3 text-sm">
                            <div class="text-center">
                                <div class="text-ai font-bold">${rule.tuningCount}次</div>
                                <div class="text-xs text-gray-500">调优次数</div>
                            </div>
                            <div class="text-center">
                                <div class="text-blue-600 font-bold">${rule.adaptations}</div>
                                <div class="text-xs text-gray-500">自适应次数</div>
                            </div>
                            <div class="text-center">
                                <div class="text-green-600 font-bold">${rule.confidence}</div>
                                <div class="text-xs text-gray-500">置信度</div>
                            </div>
                        </div>
                    </div>
                    <div class="flex space-x-3">
                        <button onclick="editRule('${rule.name}')" class="flex-1 bg-ai text-white py-2 rounded-lg hover:bg-purple-700">
                            <i class="fas fa-edit mr-2"></i>编辑规则
                        </button>
                        <button onclick="closeLearningModal()" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                            关闭
                        </button>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // 编辑规则
        function editRule(ruleName) {
            const rule = intelligentRules.find(r => r.name === ruleName);
            if (!rule) return;

            const modal = document.getElementById('learning-modal');
            const content = document.getElementById('learning-modal-content');
            
            content.innerHTML = `
                <div class="space-y-4">
                    <div class="text-center mb-4">
                        <div class="w-16 h-16 bg-ai/10 rounded-full flex items-center justify-center mx-auto mb-3">
                            <i class="fas fa-edit text-ai text-2xl"></i>
                        </div>
                        <h4 class="text-lg font-semibold text-gray-800">修改AI规则</h4>
                        <p class="text-sm text-gray-600">编辑 <code class="bg-gray-100 px-2 py-1 rounded">${rule.name}</code> 的配置</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">特征内容</label>
                        <input type="text" id="edit-feature" value="${rule.feature}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">AI学习类型</label>
                        <select id="edit-learn-type" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                            <option value="良性模式识别" ${rule.learnType === '良性模式识别' ? 'selected' : ''}>良性模式识别</option>
                            <option value="运维行为模式" ${rule.learnType === '运维行为模式' ? 'selected' : ''}>运维行为模式</option>
                            <option value="内部域名模式" ${rule.learnType === '内部域名模式' ? 'selected' : ''}>内部域名模式</option>
                            <option value="GPT研判优化" ${rule.learnType === 'GPT研判优化' ? 'selected' : ''}>GPT研判优化</option>
                            <option value="业务特征模式" ${rule.learnType === '业务特征模式' ? 'selected' : ''}>业务特征模式</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">忽略范围</label>
                        <select id="edit-ignore-scope" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                            <option value="全局忽略" ${rule.ignoreScope === '全局忽略' ? 'selected' : ''}>全局忽略</option>
                            <option value="仅在Web攻击告警中忽略" ${rule.ignoreScope === '仅在Web攻击告警中忽略' ? 'selected' : ''}>仅在Web攻击告警中忽略</option>
                            <option value="仅在SQL注入告警中忽略" ${rule.ignoreScope === '仅在SQL注入告警中忽略' ? 'selected' : ''}>仅在SQL注入告警中忽略</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">生效资产</label>
                        <select id="edit-asset-scope" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ai">
                            <option value="全部" ${rule.assetScope === '全部' ? 'selected' : ''}>全部</option>
                            <option value="生产环境资产" ${rule.assetScope === '生产环境资产' ? 'selected' : ''}>生产环境资产</option>
                            <option value="测试环境资产" ${rule.assetScope === '测试环境资产' ? 'selected' : ''}>测试环境资产</option>
                            <option value="办公网资产" ${rule.assetScope === '办公网资产' ? 'selected' : ''}>办公网资产</option>
                            <option value="DMZ区域资产" ${rule.assetScope === 'DMZ区域资产' ? 'selected' : ''}>DMZ区域资产</option>
                            <option value="核心业务资产" ${rule.assetScope === '核心业务资产' ? 'selected' : ''}>核心业务资产</option>
                            <option value="Web服务器" ${rule.assetScope === 'Web服务器' ? 'selected' : ''}>Web服务器</option>
                            <option value="数据库服务器" ${rule.assetScope === '数据库服务器' ? 'selected' : ''}>数据库服务器</option>
                            <option value="应用服务器" ${rule.assetScope === '应用服务器' ? 'selected' : ''}>应用服务器</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">备注</label>
                        <textarea id="edit-remark" class="w-full px-3 py-2 border border-gray-300 rounded-lg h-20 resize-none focus:outline-none focus:ring-2 focus:ring-ai">${rule.remark}</textarea>
                    </div>
                    <div class="flex space-x-3">
                        <button onclick="saveRuleEdit('${rule.name}')" class="flex-1 bg-ai text-white py-2 rounded-lg hover:bg-purple-700">
                            <i class="fas fa-save mr-2"></i>保存修改
                        </button>
                        <button onclick="closeLearningModal()" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                            取消
                        </button>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // 保存规则编辑
        function saveRuleEdit(ruleName) {
            const feature = document.getElementById('edit-feature').value.trim();
            const learnType = document.getElementById('edit-learn-type').value;
            const ignoreScope = document.getElementById('edit-ignore-scope').value;
            const assetScope = document.getElementById('edit-asset-scope').value;
            const remark = document.getElementById('edit-remark').value.trim();

            if (!feature) {
                showNotification('请填写特征内容', 'error');
                return;
            }

            // 更新规则数据
            const ruleIndex = intelligentRules.findIndex(r => r.name === ruleName);
            if (ruleIndex !== -1) {
                intelligentRules[ruleIndex] = {
                    ...intelligentRules[ruleIndex],
                    feature,
                    learnType,
                    ignoreScope,
                    assetScope,
                    remark,
                    lastOptimized: '刚刚'
                };
            }

            showNotification('AI规则已更新', 'success');
            closeLearningModal();
            
            // 重新渲染规则列表
            initializeCustomRules();
        }

        // 处置知识库相关函数
        function refreshDisposalSuggestions() {
            showNotification('AI建议已刷新', 'success');
            // 这里可以添加实际的刷新逻辑
        }

        function applyDisposalSuggestion(suggestionType) {
            const suggestions = {
                'auto-health-check': {
                    title: '自动化健康检查告警',
                    message: '已为健康检查告警配置自动化处理规则',
                    effect: '预计节省95%的处理时间'
                },
                'optimize-brute-force': {
                    title: '优化暴力破解攻击处置',
                    message: '已调整暴力破解攻击的监控策略为预防型',
                    effect: '预计提升40%的防护效果'
                },
                'improve-collaboration': {
                    title: '改善业务协作机制',
                    message: '已建立与业务方的快速响应机制',
                    effect: '预计提升60%的响应速度'
                },
                'backup-verification': {
                    title: '增强数据安全保护',
                    message: '已配置高危事件处置时的备份验证流程',
                    effect: '预计提升80%的数据安全'
                }
            };

            const suggestion = suggestions[suggestionType];
            if (suggestion) {
                showNotification(`${suggestion.message}。${suggestion.effect}`, 'success');
                
                // 可以在这里添加实际的应用逻辑
                console.log('应用处置建议:', suggestion);
            } else {
                showNotification('未知的建议类型', 'error');
            }
        }

        // 初始化处置知识库数据
        function initializeDisposalKnowledge() {
            // 模拟处置习惯统计数据
            const disposalStats = {
                totalHabits: 23,
                todayNew: 5,
                categories: {
                    highRisk: 8,
                    mediumRisk: 7,
                    lowRisk: 5,
                    business: 3
                }
            };

            // 更新页面统计数据
            const statsElements = document.querySelectorAll('[data-disposal-stat]');
            statsElements.forEach(element => {
                const statType = element.getAttribute('data-disposal-stat');
                if (disposalStats[statType]) {
                    element.textContent = disposalStats[statType];
                }
            });

            console.log('处置知识库初始化完成', disposalStats);
        }
    </script>
</body>
</html> 